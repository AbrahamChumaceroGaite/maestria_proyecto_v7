"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/login/route";
exports.ids = ["app/api/auth/login/route"];
exports.modules = {

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "better-sqlite3":
/*!*********************************!*\
  !*** external "better-sqlite3" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("better-sqlite3");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5CAbraham%5COneDrive%5CUniversidad%5CMaestria%5CModulo%207%5CProyecto%20Final%5Cmaestria_proyecto_v7%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAbraham%5COneDrive%5CUniversidad%5CMaestria%5CModulo%207%5CProyecto%20Final%5Cmaestria_proyecto_v7&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5CAbraham%5COneDrive%5CUniversidad%5CMaestria%5CModulo%207%5CProyecto%20Final%5Cmaestria_proyecto_v7%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAbraham%5COneDrive%5CUniversidad%5CMaestria%5CModulo%207%5CProyecto%20Final%5Cmaestria_proyecto_v7&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Abraham_OneDrive_Universidad_Maestria_Modulo_7_Proyecto_Final_maestria_proyecto_v7_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/login/route.ts */ \"(rsc)/./app/api/auth/login/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/login/route\",\n        pathname: \"/api/auth/login\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/login/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Abraham\\\\OneDrive\\\\Universidad\\\\Maestria\\\\Modulo 7\\\\Proyecto Final\\\\maestria_proyecto_v7\\\\app\\\\api\\\\auth\\\\login\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Abraham_OneDrive_Universidad_Maestria_Modulo_7_Proyecto_Final_maestria_proyecto_v7_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/login/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGbG9naW4lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNBYnJhaGFtJTVDT25lRHJpdmUlNUNVbml2ZXJzaWRhZCU1Q01hZXN0cmlhJTVDTW9kdWxvJTIwNyU1Q1Byb3llY3RvJTIwRmluYWwlNUNtYWVzdHJpYV9wcm95ZWN0b192NyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDQWJyYWhhbSU1Q09uZURyaXZlJTVDVW5pdmVyc2lkYWQlNUNNYWVzdHJpYSU1Q01vZHVsbyUyMDclNUNQcm95ZWN0byUyMEZpbmFsJTVDbWFlc3RyaWFfcHJveWVjdG9fdjcmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ29GO0FBQ2pLO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ2VzdG9yLWNvbnRyYXNlbmFzLXNlZ3Vyby8/OWVmYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxBYnJhaGFtXFxcXE9uZURyaXZlXFxcXFVuaXZlcnNpZGFkXFxcXE1hZXN0cmlhXFxcXE1vZHVsbyA3XFxcXFByb3llY3RvIEZpbmFsXFxcXG1hZXN0cmlhX3Byb3llY3RvX3Y3XFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxsb2dpblxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9sb2dpbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvbG9naW5cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvbG9naW4vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxBYnJhaGFtXFxcXE9uZURyaXZlXFxcXFVuaXZlcnNpZGFkXFxcXE1hZXN0cmlhXFxcXE1vZHVsbyA3XFxcXFByb3llY3RvIEZpbmFsXFxcXG1hZXN0cmlhX3Byb3llY3RvX3Y3XFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxsb2dpblxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYXV0aC9sb2dpbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5CAbraham%5COneDrive%5CUniversidad%5CMaestria%5CModulo%207%5CProyecto%20Final%5Cmaestria_proyecto_v7%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAbraham%5COneDrive%5CUniversidad%5CMaestria%5CModulo%207%5CProyecto%20Final%5Cmaestria_proyecto_v7&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/login/route.ts":
/*!*************************************!*\
  !*** ./app/api/auth/login/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _lib_database_models__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/database/models */ \"(rsc)/./lib/database/models.ts\");\n/* harmony import */ var _lib_crypto_hashing__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../lib/crypto/hashing */ \"(rsc)/./lib/crypto/hashing.ts\");\n/* harmony import */ var _lib_auth_session__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../lib/auth/session */ \"(rsc)/./lib/auth/session.ts\");\n/* harmony import */ var _lib_utils_validation__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../lib/utils/validation */ \"(rsc)/./lib/utils/validation.ts\");\n/* harmony import */ var _lib_utils_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../lib/utils/constants */ \"(rsc)/./lib/utils/constants.ts\");\n\n\n\n\n\n\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const validationResult = _lib_utils_validation__WEBPACK_IMPORTED_MODULE_5__.loginSchema.safeParse(body);\n        if (!validationResult.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: validationResult.error.errors[0].message\n            }, {\n                status: 400\n            });\n        }\n        const { email, masterPassword } = validationResult.data;\n        const user = _lib_database_models__WEBPACK_IMPORTED_MODULE_2__.UserModel.findByEmail(email);\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: _lib_utils_constants__WEBPACK_IMPORTED_MODULE_6__.VALIDATION_MESSAGES.INVALID_CREDENTIALS\n            }, {\n                status: 401\n            });\n        }\n        const isValidPassword = await (0,_lib_crypto_hashing__WEBPACK_IMPORTED_MODULE_3__.verifyMasterPassword)(masterPassword, user.masterPasswordHash);\n        if (!isValidPassword) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: _lib_utils_constants__WEBPACK_IMPORTED_MODULE_6__.VALIDATION_MESSAGES.INVALID_CREDENTIALS\n            }, {\n                status: 401\n            });\n        }\n        const token = (0,_lib_auth_session__WEBPACK_IMPORTED_MODULE_4__.createSession)(user.id, user.email);\n        const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n        cookieStore.set(\"session\", token, {\n            httpOnly: true,\n            secure: \"development\" === \"production\",\n            sameSite: \"lax\",\n            maxAge: 24 * 60 * 60,\n            path: \"/\"\n        });\n        const authResponse = {\n            token,\n            user: {\n                id: user.id,\n                email: user.email,\n                createdAt: user.createdAt,\n                updatedAt: user.updatedAt\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: authResponse,\n            message: \"Inicio de sesi\\xf3n exitoso\"\n        });\n    } catch (error) {\n        console.error(\"Login error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: _lib_utils_constants__WEBPACK_IMPORTED_MODULE_6__.VALIDATION_MESSAGES.SERVER_ERROR\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvbG9naW4vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBd0Q7QUFDakI7QUFDcUI7QUFDVTtBQUNUO0FBQ0U7QUFDTztBQUcvRCxlQUFlTyxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRCxRQUFRRSxJQUFJO1FBRS9CLE1BQU1DLG1CQUFtQk4sOERBQVdBLENBQUNPLFNBQVMsQ0FBQ0g7UUFDL0MsSUFBSSxDQUFDRSxpQkFBaUJFLE9BQU8sRUFBRTtZQUM3QixPQUFPYixxREFBWUEsQ0FBQ1UsSUFBSSxDQUFjO2dCQUNwQ0csU0FBUztnQkFDVEMsT0FBT0gsaUJBQWlCRyxLQUFLLENBQUNDLE1BQU0sQ0FBQyxFQUFFLENBQUNDLE9BQU87WUFDakQsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ25CO1FBRUEsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLGNBQWMsRUFBRSxHQUFHUixpQkFBaUJTLElBQUk7UUFFdkQsTUFBTUMsT0FBT25CLDJEQUFTQSxDQUFDb0IsV0FBVyxDQUFDSjtRQUNuQyxJQUFJLENBQUNHLE1BQU07WUFDVCxPQUFPckIscURBQVlBLENBQUNVLElBQUksQ0FBYztnQkFDcENHLFNBQVM7Z0JBQ1RDLE9BQU9SLHFFQUFtQkEsQ0FBQ2lCLG1CQUFtQjtZQUNoRCxHQUFHO2dCQUFFTixRQUFRO1lBQUk7UUFDbkI7UUFFQSxNQUFNTyxrQkFBa0IsTUFBTXJCLHlFQUFvQkEsQ0FBQ2dCLGdCQUFnQkUsS0FBS0ksa0JBQWtCO1FBQzFGLElBQUksQ0FBQ0QsaUJBQWlCO1lBQ3BCLE9BQU94QixxREFBWUEsQ0FBQ1UsSUFBSSxDQUFjO2dCQUNwQ0csU0FBUztnQkFDVEMsT0FBT1IscUVBQW1CQSxDQUFDaUIsbUJBQW1CO1lBQ2hELEdBQUc7Z0JBQUVOLFFBQVE7WUFBSTtRQUNuQjtRQUVBLE1BQU1TLFFBQVF0QixnRUFBYUEsQ0FBQ2lCLEtBQUtNLEVBQUUsRUFBRU4sS0FBS0gsS0FBSztRQUUvQyxNQUFNVSxjQUFjM0IscURBQU9BO1FBQzNCMkIsWUFBWUMsR0FBRyxDQUFDLFdBQVdILE9BQU87WUFDaENJLFVBQVU7WUFDVkMsUUFBUUMsa0JBQXlCO1lBQ2pDQyxVQUFVO1lBQ1ZDLFFBQVEsS0FBSyxLQUFLO1lBQ2xCQyxNQUFNO1FBQ1I7UUFFQSxNQUFNQyxlQUE2QjtZQUNqQ1Y7WUFDQUwsTUFBTTtnQkFDSk0sSUFBSU4sS0FBS00sRUFBRTtnQkFDWFQsT0FBT0csS0FBS0gsS0FBSztnQkFDakJtQixXQUFXaEIsS0FBS2dCLFNBQVM7Z0JBQ3pCQyxXQUFXakIsS0FBS2lCLFNBQVM7WUFDM0I7UUFDRjtRQUVBLE9BQU90QyxxREFBWUEsQ0FBQ1UsSUFBSSxDQUE0QjtZQUNsREcsU0FBUztZQUNUTyxNQUFNZ0I7WUFDTnBCLFNBQVM7UUFDWDtJQUVGLEVBQUUsT0FBT0YsT0FBTztRQUNkeUIsUUFBUXpCLEtBQUssQ0FBQyxnQkFBZ0JBO1FBQzlCLE9BQU9kLHFEQUFZQSxDQUFDVSxJQUFJLENBQWM7WUFDcENHLFNBQVM7WUFDVEMsT0FBT1IscUVBQW1CQSxDQUFDa0MsWUFBWTtRQUN6QyxHQUFHO1lBQUV2QixRQUFRO1FBQUk7SUFDbkI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2dlc3Rvci1jb250cmFzZW5hcy1zZWd1cm8vLi9hcHAvYXBpL2F1dGgvbG9naW4vcm91dGUudHM/NGYyNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJztcclxuaW1wb3J0IHsgVXNlck1vZGVsIH0gZnJvbSAnLi4vLi4vLi4vLi4vbGliL2RhdGFiYXNlL21vZGVscyc7XHJcbmltcG9ydCB7IHZlcmlmeU1hc3RlclBhc3N3b3JkIH0gZnJvbSAnLi4vLi4vLi4vLi4vbGliL2NyeXB0by9oYXNoaW5nJztcclxuaW1wb3J0IHsgY3JlYXRlU2Vzc2lvbiB9IGZyb20gJy4uLy4uLy4uLy4uL2xpYi9hdXRoL3Nlc3Npb24nO1xyXG5pbXBvcnQgeyBsb2dpblNjaGVtYSB9IGZyb20gJy4uLy4uLy4uLy4uL2xpYi91dGlscy92YWxpZGF0aW9uJztcclxuaW1wb3J0IHsgVkFMSURBVElPTl9NRVNTQUdFUyB9IGZyb20gJy4uLy4uLy4uLy4uL2xpYi91dGlscy9jb25zdGFudHMnO1xyXG5pbXBvcnQgdHlwZSB7IEFwaVJlc3BvbnNlLCBBdXRoUmVzcG9uc2UgfSBmcm9tICcuLi8uLi8uLi8uLi9saWIvdHlwZXMnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBQcm9taXNlPE5leHRSZXNwb25zZT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSBsb2dpblNjaGVtYS5zYWZlUGFyc2UoYm9keSk7XHJcbiAgICBpZiAoIXZhbGlkYXRpb25SZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb248QXBpUmVzcG9uc2U+KHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogdmFsaWRhdGlvblJlc3VsdC5lcnJvci5lcnJvcnNbMF0ubWVzc2FnZSxcclxuICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGVtYWlsLCBtYXN0ZXJQYXNzd29yZCB9ID0gdmFsaWRhdGlvblJlc3VsdC5kYXRhO1xyXG5cclxuICAgIGNvbnN0IHVzZXIgPSBVc2VyTW9kZWwuZmluZEJ5RW1haWwoZW1haWwpO1xyXG4gICAgaWYgKCF1c2VyKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbjxBcGlSZXNwb25zZT4oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBWQUxJREFUSU9OX01FU1NBR0VTLklOVkFMSURfQ1JFREVOVElBTFMsXHJcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaXNWYWxpZFBhc3N3b3JkID0gYXdhaXQgdmVyaWZ5TWFzdGVyUGFzc3dvcmQobWFzdGVyUGFzc3dvcmQsIHVzZXIubWFzdGVyUGFzc3dvcmRIYXNoKTtcclxuICAgIGlmICghaXNWYWxpZFBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbjxBcGlSZXNwb25zZT4oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBWQUxJREFUSU9OX01FU1NBR0VTLklOVkFMSURfQ1JFREVOVElBTFMsXHJcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdG9rZW4gPSBjcmVhdGVTZXNzaW9uKHVzZXIuaWQsIHVzZXIuZW1haWwpO1xyXG4gICAgXHJcbiAgICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICAgIGNvb2tpZVN0b3JlLnNldCgnc2Vzc2lvbicsIHRva2VuLCB7XHJcbiAgICAgIGh0dHBPbmx5OiB0cnVlLFxyXG4gICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXHJcbiAgICAgIHNhbWVTaXRlOiAnbGF4JyxcclxuICAgICAgbWF4QWdlOiAyNCAqIDYwICogNjAsXHJcbiAgICAgIHBhdGg6ICcvJyxcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGF1dGhSZXNwb25zZTogQXV0aFJlc3BvbnNlID0ge1xyXG4gICAgICB0b2tlbixcclxuICAgICAgdXNlcjoge1xyXG4gICAgICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogdXNlci5jcmVhdGVkQXQsXHJcbiAgICAgICAgdXBkYXRlZEF0OiB1c2VyLnVwZGF0ZWRBdCxcclxuICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFwaVJlc3BvbnNlPEF1dGhSZXNwb25zZT4+KHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgZGF0YTogYXV0aFJlc3BvbnNlLFxyXG4gICAgICBtZXNzYWdlOiAnSW5pY2lvIGRlIHNlc2nDs24gZXhpdG9zbycsXHJcbiAgICB9KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbjxBcGlSZXNwb25zZT4oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IFZBTElEQVRJT05fTUVTU0FHRVMuU0VSVkVSX0VSUk9SLFxyXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY29va2llcyIsIlVzZXJNb2RlbCIsInZlcmlmeU1hc3RlclBhc3N3b3JkIiwiY3JlYXRlU2Vzc2lvbiIsImxvZ2luU2NoZW1hIiwiVkFMSURBVElPTl9NRVNTQUdFUyIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJ2YWxpZGF0aW9uUmVzdWx0Iiwic2FmZVBhcnNlIiwic3VjY2VzcyIsImVycm9yIiwiZXJyb3JzIiwibWVzc2FnZSIsInN0YXR1cyIsImVtYWlsIiwibWFzdGVyUGFzc3dvcmQiLCJkYXRhIiwidXNlciIsImZpbmRCeUVtYWlsIiwiSU5WQUxJRF9DUkVERU5USUFMUyIsImlzVmFsaWRQYXNzd29yZCIsIm1hc3RlclBhc3N3b3JkSGFzaCIsInRva2VuIiwiaWQiLCJjb29raWVTdG9yZSIsInNldCIsImh0dHBPbmx5Iiwic2VjdXJlIiwicHJvY2VzcyIsInNhbWVTaXRlIiwibWF4QWdlIiwicGF0aCIsImF1dGhSZXNwb25zZSIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsImNvbnNvbGUiLCJTRVJWRVJfRVJST1IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/login/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth/session.ts":
/*!*****************************!*\
  !*** ./lib/auth/session.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearSessionCookie: () => (/* binding */ clearSessionCookie),\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   getSessionFromCookies: () => (/* binding */ getSessionFromCookies),\n/* harmony export */   getSessionRemainingTime: () => (/* binding */ getSessionRemainingTime),\n/* harmony export */   isSessionExpired: () => (/* binding */ isSessionExpired),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie),\n/* harmony export */   verifySession: () => (/* binding */ verifySession)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _utils_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/constants */ \"(rsc)/./lib/utils/constants.ts\");\n\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"fallback-secret-key-change-in-production\";\nfunction createSession(userId, email) {\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign({\n        userId,\n        email\n    }, JWT_SECRET, {\n        expiresIn: _utils_constants__WEBPACK_IMPORTED_MODULE_2__.JWT_CONFIG.EXPIRES_IN,\n        algorithm: _utils_constants__WEBPACK_IMPORTED_MODULE_2__.JWT_CONFIG.ALGORITHM\n    });\n}\nfunction verifySession(token) {\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET);\n        return {\n            id: decoded.userId,\n            email: decoded.email,\n            iat: decoded.iat,\n            exp: decoded.exp\n        };\n    } catch  {\n        return null;\n    }\n}\nfunction getSessionFromCookies() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const token = cookieStore.get(\"session\")?.value;\n    if (!token) return null;\n    return verifySession(token);\n}\nfunction setSessionCookie(token) {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    cookieStore.set(\"session\", token, {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        maxAge: 24 * 60 * 60,\n        path: \"/\"\n    });\n}\nfunction clearSessionCookie() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    cookieStore.set(\"session\", \"\", {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        maxAge: 0,\n        path: \"/\"\n    });\n}\nfunction isSessionExpired(session) {\n    const now = Math.floor(Date.now() / 1000);\n    return session.exp < now;\n}\nfunction getSessionRemainingTime(session) {\n    const now = Math.floor(Date.now() / 1000);\n    return Math.max(0, session.exp - now);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC9zZXNzaW9uLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStCO0FBQ1E7QUFFUztBQUVoRCxNQUFNRyxhQUFhQyxRQUFRQyxHQUFHLENBQUNGLFVBQVUsSUFBSTtBQUV0QyxTQUFTRyxjQUFjQyxNQUFjLEVBQUVDLEtBQWE7SUFDekQsT0FBT1Isd0RBQVEsQ0FDYjtRQUFFTztRQUFRQztJQUFNLEdBQ2hCTCxZQUNBO1FBQ0VPLFdBQVdSLHdEQUFVQSxDQUFDUyxVQUFVO1FBQ2hDQyxXQUFXVix3REFBVUEsQ0FBQ1csU0FBUztJQUNqQztBQUVKO0FBRU8sU0FBU0MsY0FBY0MsS0FBYTtJQUN6QyxJQUFJO1FBQ0YsTUFBTUMsVUFBVWhCLDBEQUFVLENBQUNlLE9BQU9aO1FBRWxDLE9BQU87WUFDTGUsSUFBSUYsUUFBUVQsTUFBTTtZQUNsQkMsT0FBT1EsUUFBUVIsS0FBSztZQUNwQlcsS0FBS0gsUUFBUUcsR0FBRztZQUNoQkMsS0FBS0osUUFBUUksR0FBRztRQUNsQjtJQUNGLEVBQUUsT0FBTTtRQUNOLE9BQU87SUFDVDtBQUNGO0FBRU8sU0FBU0M7SUFDZCxNQUFNQyxjQUFjckIscURBQU9BO0lBQzNCLE1BQU1jLFFBQVFPLFlBQVlDLEdBQUcsQ0FBQyxZQUFZQztJQUUxQyxJQUFJLENBQUNULE9BQU8sT0FBTztJQUVuQixPQUFPRCxjQUFjQztBQUN2QjtBQUVPLFNBQVNVLGlCQUFpQlYsS0FBYTtJQUM1QyxNQUFNTyxjQUFjckIscURBQU9BO0lBRTNCcUIsWUFBWUksR0FBRyxDQUFDLFdBQVdYLE9BQU87UUFDaENZLFVBQVU7UUFDVkMsUUFBUXhCLGtCQUF5QjtRQUNqQ3lCLFVBQVU7UUFDVkMsUUFBUSxLQUFLLEtBQUs7UUFDbEJDLE1BQU07SUFDUjtBQUNGO0FBRU8sU0FBU0M7SUFDZCxNQUFNVixjQUFjckIscURBQU9BO0lBRTNCcUIsWUFBWUksR0FBRyxDQUFDLFdBQVcsSUFBSTtRQUM3QkMsVUFBVTtRQUNWQyxRQUFReEIsa0JBQXlCO1FBQ2pDeUIsVUFBVTtRQUNWQyxRQUFRO1FBQ1JDLE1BQU07SUFDUjtBQUNGO0FBRU8sU0FBU0UsaUJBQWlCQyxPQUFvQjtJQUNuRCxNQUFNQyxNQUFNQyxLQUFLQyxLQUFLLENBQUNDLEtBQUtILEdBQUcsS0FBSztJQUNwQyxPQUFPRCxRQUFRZCxHQUFHLEdBQUdlO0FBQ3ZCO0FBRU8sU0FBU0ksd0JBQXdCTCxPQUFvQjtJQUMxRCxNQUFNQyxNQUFNQyxLQUFLQyxLQUFLLENBQUNDLEtBQUtILEdBQUcsS0FBSztJQUNwQyxPQUFPQyxLQUFLSSxHQUFHLENBQUMsR0FBR04sUUFBUWQsR0FBRyxHQUFHZTtBQUNuQyIsInNvdXJjZXMiOlsid2VicGFjazovL2dlc3Rvci1jb250cmFzZW5hcy1zZWd1cm8vLi9saWIvYXV0aC9zZXNzaW9uLnRzP2Y2NTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xyXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJztcclxuaW1wb3J0IHR5cGUgeyBTZXNzaW9uVXNlciB9IGZyb20gJy4uL3R5cGVzJztcclxuaW1wb3J0IHsgSldUX0NPTkZJRyB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cyc7XHJcblxyXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAnZmFsbGJhY2stc2VjcmV0LWtleS1jaGFuZ2UtaW4tcHJvZHVjdGlvbic7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2Vzc2lvbih1c2VySWQ6IHN0cmluZywgZW1haWw6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGp3dC5zaWduKFxyXG4gICAgeyB1c2VySWQsIGVtYWlsIH0sXHJcbiAgICBKV1RfU0VDUkVULFxyXG4gICAgeyBcclxuICAgICAgZXhwaXJlc0luOiBKV1RfQ09ORklHLkVYUElSRVNfSU4sXHJcbiAgICAgIGFsZ29yaXRobTogSldUX0NPTkZJRy5BTEdPUklUSE0gYXMgand0LkFsZ29yaXRobVxyXG4gICAgfVxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlTZXNzaW9uKHRva2VuOiBzdHJpbmcpOiBTZXNzaW9uVXNlciB8IG51bGwge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCkgYXMgand0Lkp3dFBheWxvYWQ7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiBkZWNvZGVkLnVzZXJJZCxcclxuICAgICAgZW1haWw6IGRlY29kZWQuZW1haWwsXHJcbiAgICAgIGlhdDogZGVjb2RlZC5pYXQhLFxyXG4gICAgICBleHA6IGRlY29kZWQuZXhwISxcclxuICAgIH07XHJcbiAgfSBjYXRjaCB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXNzaW9uRnJvbUNvb2tpZXMoKTogU2Vzc2lvblVzZXIgfCBudWxsIHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICBjb25zdCB0b2tlbiA9IGNvb2tpZVN0b3JlLmdldCgnc2Vzc2lvbicpPy52YWx1ZTtcclxuICBcclxuICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcclxuICBcclxuICByZXR1cm4gdmVyaWZ5U2Vzc2lvbih0b2tlbik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRTZXNzaW9uQ29va2llKHRva2VuOiBzdHJpbmcpOiB2b2lkIHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICBcclxuICBjb29raWVTdG9yZS5zZXQoJ3Nlc3Npb24nLCB0b2tlbiwge1xyXG4gICAgaHR0cE9ubHk6IHRydWUsXHJcbiAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXHJcbiAgICBzYW1lU2l0ZTogJ2xheCcsXHJcbiAgICBtYXhBZ2U6IDI0ICogNjAgKiA2MCxcclxuICAgIHBhdGg6ICcvJyxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyU2Vzc2lvbkNvb2tpZSgpOiB2b2lkIHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICBcclxuICBjb29raWVTdG9yZS5zZXQoJ3Nlc3Npb24nLCAnJywge1xyXG4gICAgaHR0cE9ubHk6IHRydWUsXHJcbiAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXHJcbiAgICBzYW1lU2l0ZTogJ2xheCcsXHJcbiAgICBtYXhBZ2U6IDAsXHJcbiAgICBwYXRoOiAnLycsXHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1Nlc3Npb25FeHBpcmVkKHNlc3Npb246IFNlc3Npb25Vc2VyKTogYm9vbGVhbiB7XHJcbiAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XHJcbiAgcmV0dXJuIHNlc3Npb24uZXhwIDwgbm93O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2Vzc2lvblJlbWFpbmluZ1RpbWUoc2Vzc2lvbjogU2Vzc2lvblVzZXIpOiBudW1iZXIge1xyXG4gIGNvbnN0IG5vdyA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApO1xyXG4gIHJldHVybiBNYXRoLm1heCgwLCBzZXNzaW9uLmV4cCAtIG5vdyk7XHJcbn0iXSwibmFtZXMiOlsiand0IiwiY29va2llcyIsIkpXVF9DT05GSUciLCJKV1RfU0VDUkVUIiwicHJvY2VzcyIsImVudiIsImNyZWF0ZVNlc3Npb24iLCJ1c2VySWQiLCJlbWFpbCIsInNpZ24iLCJleHBpcmVzSW4iLCJFWFBJUkVTX0lOIiwiYWxnb3JpdGhtIiwiQUxHT1JJVEhNIiwidmVyaWZ5U2Vzc2lvbiIsInRva2VuIiwiZGVjb2RlZCIsInZlcmlmeSIsImlkIiwiaWF0IiwiZXhwIiwiZ2V0U2Vzc2lvbkZyb21Db29raWVzIiwiY29va2llU3RvcmUiLCJnZXQiLCJ2YWx1ZSIsInNldFNlc3Npb25Db29raWUiLCJzZXQiLCJodHRwT25seSIsInNlY3VyZSIsInNhbWVTaXRlIiwibWF4QWdlIiwicGF0aCIsImNsZWFyU2Vzc2lvbkNvb2tpZSIsImlzU2Vzc2lvbkV4cGlyZWQiLCJzZXNzaW9uIiwibm93IiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsImdldFNlc3Npb25SZW1haW5pbmdUaW1lIiwibWF4Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth/session.ts\n");

/***/ }),

/***/ "(rsc)/./lib/crypto/hashing.ts":
/*!*******************************!*\
  !*** ./lib/crypto/hashing.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createHMAC: () => (/* binding */ createHMAC),\n/* harmony export */   createPasswordHash: () => (/* binding */ createPasswordHash),\n/* harmony export */   generateSecureToken: () => (/* binding */ generateSecureToken),\n/* harmony export */   hashData: () => (/* binding */ hashData),\n/* harmony export */   hashMasterPassword: () => (/* binding */ hashMasterPassword),\n/* harmony export */   verifyHMAC: () => (/* binding */ verifyHMAC),\n/* harmony export */   verifyMasterPassword: () => (/* binding */ verifyMasterPassword)\n/* harmony export */ });\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/constants */ \"(rsc)/./lib/utils/constants.ts\");\n\n\n\nasync function hashMasterPassword(password) {\n    return bcrypt__WEBPACK_IMPORTED_MODULE_0___default().hash(password, _utils_constants__WEBPACK_IMPORTED_MODULE_2__.PASSWORD_CONFIG.BCRYPT_ROUNDS);\n}\nasync function verifyMasterPassword(password, hash) {\n    return bcrypt__WEBPACK_IMPORTED_MODULE_0___default().compare(password, hash);\n}\nfunction createPasswordHash(password) {\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().createHash(\"sha256\").update(password).digest(\"hex\");\n}\nfunction generateSecureToken(length = 32) {\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().randomBytes(length).toString(\"hex\");\n}\nfunction hashData(data, algorithm = \"sha256\") {\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().createHash(algorithm).update(data).digest(\"hex\");\n}\nfunction createHMAC(data, secret) {\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().createHmac(\"sha256\", secret).update(data).digest(\"hex\");\n}\nfunction verifyHMAC(data, secret, signature) {\n    const expectedSignature = createHMAC(data, secret);\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().timingSafeEqual(Buffer.from(expectedSignature, \"hex\"), Buffer.from(signature, \"hex\"));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY3J5cHRvL2hhc2hpbmcudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQTRCO0FBQ0E7QUFDeUI7QUFFOUMsZUFBZUcsbUJBQW1CQyxRQUFnQjtJQUN2RCxPQUFPSixrREFBVyxDQUFDSSxVQUFVRiw2REFBZUEsQ0FBQ0ksYUFBYTtBQUM1RDtBQUVPLGVBQWVDLHFCQUFxQkgsUUFBZ0IsRUFBRUMsSUFBWTtJQUN2RSxPQUFPTCxxREFBYyxDQUFDSSxVQUFVQztBQUNsQztBQUVPLFNBQVNJLG1CQUFtQkwsUUFBZ0I7SUFDakQsT0FBT0gsd0RBQWlCLENBQUMsVUFBVVUsTUFBTSxDQUFDUCxVQUFVUSxNQUFNLENBQUM7QUFDN0Q7QUFFTyxTQUFTQyxvQkFBb0JDLFNBQWlCLEVBQUU7SUFDckQsT0FBT2IseURBQWtCLENBQUNhLFFBQVFFLFFBQVEsQ0FBQztBQUM3QztBQUVPLFNBQVNDLFNBQVNDLElBQVksRUFBRUMsWUFBb0IsUUFBUTtJQUNqRSxPQUFPbEIsd0RBQWlCLENBQUNrQixXQUFXUixNQUFNLENBQUNPLE1BQU1OLE1BQU0sQ0FBQztBQUMxRDtBQUVPLFNBQVNRLFdBQVdGLElBQVksRUFBRUcsTUFBYztJQUNyRCxPQUFPcEIsd0RBQWlCLENBQUMsVUFBVW9CLFFBQVFWLE1BQU0sQ0FBQ08sTUFBTU4sTUFBTSxDQUFDO0FBQ2pFO0FBRU8sU0FBU1csV0FBV0wsSUFBWSxFQUFFRyxNQUFjLEVBQUVHLFNBQWlCO0lBQ3hFLE1BQU1DLG9CQUFvQkwsV0FBV0YsTUFBTUc7SUFDM0MsT0FBT3BCLDZEQUFzQixDQUMzQjBCLE9BQU9DLElBQUksQ0FBQ0gsbUJBQW1CLFFBQy9CRSxPQUFPQyxJQUFJLENBQUNKLFdBQVc7QUFFM0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZXN0b3ItY29udHJhc2VuYXMtc2VndXJvLy4vbGliL2NyeXB0by9oYXNoaW5nLnRzPzljOTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHQnO1xyXG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XHJcbmltcG9ydCB7IFBBU1NXT1JEX0NPTkZJRyB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzaE1hc3RlclBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIHJldHVybiBiY3J5cHQuaGFzaChwYXNzd29yZCwgUEFTU1dPUkRfQ09ORklHLkJDUllQVF9ST1VORFMpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5TWFzdGVyUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZywgaGFzaDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgcmV0dXJuIGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCBoYXNoKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhc3N3b3JkSGFzaChwYXNzd29yZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShwYXNzd29yZCkuZGlnZXN0KCdoZXgnKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlU2VjdXJlVG9rZW4obGVuZ3RoOiBudW1iZXIgPSAzMik6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGNyeXB0by5yYW5kb21CeXRlcyhsZW5ndGgpLnRvU3RyaW5nKCdoZXgnKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc2hEYXRhKGRhdGE6IHN0cmluZywgYWxnb3JpdGhtOiBzdHJpbmcgPSAnc2hhMjU2Jyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGNyeXB0by5jcmVhdGVIYXNoKGFsZ29yaXRobSkudXBkYXRlKGRhdGEpLmRpZ2VzdCgnaGV4Jyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVITUFDKGRhdGE6IHN0cmluZywgc2VjcmV0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiBjcnlwdG8uY3JlYXRlSG1hYygnc2hhMjU2Jywgc2VjcmV0KS51cGRhdGUoZGF0YSkuZGlnZXN0KCdoZXgnKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeUhNQUMoZGF0YTogc3RyaW5nLCBzZWNyZXQ6IHN0cmluZywgc2lnbmF0dXJlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICBjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGNyZWF0ZUhNQUMoZGF0YSwgc2VjcmV0KTtcclxuICByZXR1cm4gY3J5cHRvLnRpbWluZ1NhZmVFcXVhbChcclxuICAgIEJ1ZmZlci5mcm9tKGV4cGVjdGVkU2lnbmF0dXJlLCAnaGV4JyksXHJcbiAgICBCdWZmZXIuZnJvbShzaWduYXR1cmUsICdoZXgnKVxyXG4gICk7XHJcbn0iXSwibmFtZXMiOlsiYmNyeXB0IiwiY3J5cHRvIiwiUEFTU1dPUkRfQ09ORklHIiwiaGFzaE1hc3RlclBhc3N3b3JkIiwicGFzc3dvcmQiLCJoYXNoIiwiQkNSWVBUX1JPVU5EUyIsInZlcmlmeU1hc3RlclBhc3N3b3JkIiwiY29tcGFyZSIsImNyZWF0ZVBhc3N3b3JkSGFzaCIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJkaWdlc3QiLCJnZW5lcmF0ZVNlY3VyZVRva2VuIiwibGVuZ3RoIiwicmFuZG9tQnl0ZXMiLCJ0b1N0cmluZyIsImhhc2hEYXRhIiwiZGF0YSIsImFsZ29yaXRobSIsImNyZWF0ZUhNQUMiLCJzZWNyZXQiLCJjcmVhdGVIbWFjIiwidmVyaWZ5SE1BQyIsInNpZ25hdHVyZSIsImV4cGVjdGVkU2lnbmF0dXJlIiwidGltaW5nU2FmZUVxdWFsIiwiQnVmZmVyIiwiZnJvbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/crypto/hashing.ts\n");

/***/ }),

/***/ "(rsc)/./lib/database/connection.ts":
/*!************************************!*\
  !*** ./lib/database/connection.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   beginTransaction: () => (/* binding */ beginTransaction),\n/* harmony export */   closeDatabase: () => (/* binding */ closeDatabase),\n/* harmony export */   getDatabase: () => (/* binding */ getDatabase)\n/* harmony export */ });\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-sqlite3 */ \"better-sqlite3\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(better_sqlite3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/constants */ \"(rsc)/./lib/utils/constants.ts\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nlet db = null;\nfunction getDatabase() {\n    if (!db) {\n        const dbPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"data\", _utils_constants__WEBPACK_IMPORTED_MODULE_1__.DATABASE_CONFIG.FILENAME);\n        db = new (better_sqlite3__WEBPACK_IMPORTED_MODULE_0___default())(dbPath, {\n            verbose:  true ? console.log : 0,\n            timeout: _utils_constants__WEBPACK_IMPORTED_MODULE_1__.DATABASE_CONFIG.TIMEOUT\n        });\n        db.pragma(\"journal_mode = WAL\");\n        db.pragma(\"foreign_keys = ON\");\n        db.pragma(\"synchronous = NORMAL\");\n        db.pragma(\"cache_size = -64000\");\n        db.pragma(\"temp_store = MEMORY\");\n        initializeTables();\n    }\n    return db;\n}\nfunction initializeTables() {\n    if (!db) return;\n    const createUsersTable = `\r\n    CREATE TABLE IF NOT EXISTS users (\r\n      id TEXT PRIMARY KEY,\r\n      email TEXT UNIQUE NOT NULL,\r\n      master_password_hash TEXT NOT NULL,\r\n      salt TEXT NOT NULL,\r\n      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP\r\n    )\r\n  `;\n    const createPasswordsTable = `\r\n    CREATE TABLE IF NOT EXISTS passwords (\r\n      id TEXT PRIMARY KEY,\r\n      user_id TEXT NOT NULL,\r\n      service TEXT NOT NULL,\r\n      username TEXT NOT NULL,\r\n      encrypted_password TEXT NOT NULL,\r\n      iv TEXT NOT NULL,\r\n      url TEXT,\r\n      notes TEXT,\r\n      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n      FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE\r\n    )\r\n  `;\n    const createUsersEmailIndex = `\r\n    CREATE INDEX IF NOT EXISTS idx_users_email ON users (email)\r\n  `;\n    const createPasswordsUserIdIndex = `\r\n    CREATE INDEX IF NOT EXISTS idx_passwords_user_id ON passwords (user_id)\r\n  `;\n    const createPasswordsServiceIndex = `\r\n    CREATE INDEX IF NOT EXISTS idx_passwords_service ON passwords (service)\r\n  `;\n    db.exec(createUsersTable);\n    db.exec(createPasswordsTable);\n    db.exec(createUsersEmailIndex);\n    db.exec(createPasswordsUserIdIndex);\n    db.exec(createPasswordsServiceIndex);\n}\nfunction closeDatabase() {\n    if (db) {\n        db.close();\n        db = null;\n    }\n}\nfunction beginTransaction() {\n    return getDatabase().transaction((fn)=>fn());\n}\nprocess.on(\"exit\", closeDatabase);\nprocess.on(\"SIGINT\", closeDatabase);\nprocess.on(\"SIGTERM\", closeDatabase);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGF0YWJhc2UvY29ubmVjdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzQztBQUNlO0FBQzdCO0FBRXhCLElBQUlHLEtBQStCO0FBRTVCLFNBQVNDO0lBQ2QsSUFBSSxDQUFDRCxJQUFJO1FBQ1AsTUFBTUUsU0FBU0gsZ0RBQVMsQ0FBQ0ssUUFBUUMsR0FBRyxJQUFJLFFBQVFQLDZEQUFlQSxDQUFDUSxRQUFRO1FBRXhFTixLQUFLLElBQUlILHVEQUFRQSxDQUFDSyxRQUFRO1lBQ3hCSyxTQUFTSCxLQUF5QixHQUFnQkksUUFBUUMsR0FBRyxHQUFHQyxDQUFTQTtZQUN6RUMsU0FBU2IsNkRBQWVBLENBQUNjLE9BQU87UUFDbEM7UUFFQVosR0FBR2EsTUFBTSxDQUFDO1FBQ1ZiLEdBQUdhLE1BQU0sQ0FBQztRQUNWYixHQUFHYSxNQUFNLENBQUM7UUFDVmIsR0FBR2EsTUFBTSxDQUFDO1FBQ1ZiLEdBQUdhLE1BQU0sQ0FBQztRQUVWQztJQUNGO0lBRUEsT0FBT2Q7QUFDVDtBQUVBLFNBQVNjO0lBQ1AsSUFBSSxDQUFDZCxJQUFJO0lBRVQsTUFBTWUsbUJBQW1CLENBQUM7Ozs7Ozs7OztFQVMxQixDQUFDO0lBRUQsTUFBTUMsdUJBQXVCLENBQUM7Ozs7Ozs7Ozs7Ozs7O0VBYzlCLENBQUM7SUFFRCxNQUFNQyx3QkFBd0IsQ0FBQzs7RUFFL0IsQ0FBQztJQUVELE1BQU1DLDZCQUE2QixDQUFDOztFQUVwQyxDQUFDO0lBRUQsTUFBTUMsOEJBQThCLENBQUM7O0VBRXJDLENBQUM7SUFFRG5CLEdBQUdvQixJQUFJLENBQUNMO0lBQ1JmLEdBQUdvQixJQUFJLENBQUNKO0lBQ1JoQixHQUFHb0IsSUFBSSxDQUFDSDtJQUNSakIsR0FBR29CLElBQUksQ0FBQ0Y7SUFDUmxCLEdBQUdvQixJQUFJLENBQUNEO0FBQ1Y7QUFFTyxTQUFTRTtJQUNkLElBQUlyQixJQUFJO1FBQ05BLEdBQUdzQixLQUFLO1FBQ1J0QixLQUFLO0lBQ1A7QUFDRjtBQUVPLFNBQVN1QjtJQUNkLE9BQU90QixjQUFjdUIsV0FBVyxDQUFDLENBQUNDLEtBQW1CQTtBQUN2RDtBQUVBckIsUUFBUXNCLEVBQUUsQ0FBQyxRQUFRTDtBQUNuQmpCLFFBQVFzQixFQUFFLENBQUMsVUFBVUw7QUFDckJqQixRQUFRc0IsRUFBRSxDQUFDLFdBQVdMIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ2VzdG9yLWNvbnRyYXNlbmFzLXNlZ3Vyby8uL2xpYi9kYXRhYmFzZS9jb25uZWN0aW9uLnRzP2NiNTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERhdGFiYXNlIGZyb20gJ2JldHRlci1zcWxpdGUzJztcclxuaW1wb3J0IHsgREFUQUJBU0VfQ09ORklHIH0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcblxyXG5sZXQgZGI6IERhdGFiYXNlLkRhdGFiYXNlIHwgbnVsbCA9IG51bGw7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGF0YWJhc2UoKTogRGF0YWJhc2UuRGF0YWJhc2Uge1xyXG4gIGlmICghZGIpIHtcclxuICAgIGNvbnN0IGRiUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZGF0YScsIERBVEFCQVNFX0NPTkZJRy5GSUxFTkFNRSk7XHJcbiAgICBcclxuICAgIGRiID0gbmV3IERhdGFiYXNlKGRiUGF0aCwge1xyXG4gICAgICB2ZXJib3NlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IGNvbnNvbGUubG9nIDogdW5kZWZpbmVkLFxyXG4gICAgICB0aW1lb3V0OiBEQVRBQkFTRV9DT05GSUcuVElNRU9VVCxcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBkYi5wcmFnbWEoJ2pvdXJuYWxfbW9kZSA9IFdBTCcpO1xyXG4gICAgZGIucHJhZ21hKCdmb3JlaWduX2tleXMgPSBPTicpO1xyXG4gICAgZGIucHJhZ21hKCdzeW5jaHJvbm91cyA9IE5PUk1BTCcpO1xyXG4gICAgZGIucHJhZ21hKCdjYWNoZV9zaXplID0gLTY0MDAwJyk7XHJcbiAgICBkYi5wcmFnbWEoJ3RlbXBfc3RvcmUgPSBNRU1PUlknKTtcclxuICAgIFxyXG4gICAgaW5pdGlhbGl6ZVRhYmxlcygpO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gZGI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXRpYWxpemVUYWJsZXMoKTogdm9pZCB7XHJcbiAgaWYgKCFkYikgcmV0dXJuO1xyXG4gIFxyXG4gIGNvbnN0IGNyZWF0ZVVzZXJzVGFibGUgPSBgXHJcbiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyB1c2VycyAoXHJcbiAgICAgIGlkIFRFWFQgUFJJTUFSWSBLRVksXHJcbiAgICAgIGVtYWlsIFRFWFQgVU5JUVVFIE5PVCBOVUxMLFxyXG4gICAgICBtYXN0ZXJfcGFzc3dvcmRfaGFzaCBURVhUIE5PVCBOVUxMLFxyXG4gICAgICBzYWx0IFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgIGNyZWF0ZWRfYXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcclxuICAgICAgdXBkYXRlZF9hdCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QXHJcbiAgICApXHJcbiAgYDtcclxuICBcclxuICBjb25zdCBjcmVhdGVQYXNzd29yZHNUYWJsZSA9IGBcclxuICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHBhc3N3b3JkcyAoXHJcbiAgICAgIGlkIFRFWFQgUFJJTUFSWSBLRVksXHJcbiAgICAgIHVzZXJfaWQgVEVYVCBOT1QgTlVMTCxcclxuICAgICAgc2VydmljZSBURVhUIE5PVCBOVUxMLFxyXG4gICAgICB1c2VybmFtZSBURVhUIE5PVCBOVUxMLFxyXG4gICAgICBlbmNyeXB0ZWRfcGFzc3dvcmQgVEVYVCBOT1QgTlVMTCxcclxuICAgICAgaXYgVEVYVCBOT1QgTlVMTCxcclxuICAgICAgdXJsIFRFWFQsXHJcbiAgICAgIG5vdGVzIFRFWFQsXHJcbiAgICAgIGNyZWF0ZWRfYXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcclxuICAgICAgdXBkYXRlZF9hdCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLFxyXG4gICAgICBGT1JFSUdOIEtFWSAodXNlcl9pZCkgUkVGRVJFTkNFUyB1c2VycyAoaWQpIE9OIERFTEVURSBDQVNDQURFXHJcbiAgICApXHJcbiAgYDtcclxuICBcclxuICBjb25zdCBjcmVhdGVVc2Vyc0VtYWlsSW5kZXggPSBgXHJcbiAgICBDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfdXNlcnNfZW1haWwgT04gdXNlcnMgKGVtYWlsKVxyXG4gIGA7XHJcbiAgXHJcbiAgY29uc3QgY3JlYXRlUGFzc3dvcmRzVXNlcklkSW5kZXggPSBgXHJcbiAgICBDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfcGFzc3dvcmRzX3VzZXJfaWQgT04gcGFzc3dvcmRzICh1c2VyX2lkKVxyXG4gIGA7XHJcbiAgXHJcbiAgY29uc3QgY3JlYXRlUGFzc3dvcmRzU2VydmljZUluZGV4ID0gYFxyXG4gICAgQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X3Bhc3N3b3Jkc19zZXJ2aWNlIE9OIHBhc3N3b3JkcyAoc2VydmljZSlcclxuICBgO1xyXG4gIFxyXG4gIGRiLmV4ZWMoY3JlYXRlVXNlcnNUYWJsZSk7XHJcbiAgZGIuZXhlYyhjcmVhdGVQYXNzd29yZHNUYWJsZSk7XHJcbiAgZGIuZXhlYyhjcmVhdGVVc2Vyc0VtYWlsSW5kZXgpO1xyXG4gIGRiLmV4ZWMoY3JlYXRlUGFzc3dvcmRzVXNlcklkSW5kZXgpO1xyXG4gIGRiLmV4ZWMoY3JlYXRlUGFzc3dvcmRzU2VydmljZUluZGV4KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsb3NlRGF0YWJhc2UoKTogdm9pZCB7XHJcbiAgaWYgKGRiKSB7XHJcbiAgICBkYi5jbG9zZSgpO1xyXG4gICAgZGIgPSBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJlZ2luVHJhbnNhY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGdldERhdGFiYXNlKCkudHJhbnNhY3Rpb24oKGZuOiAoKSA9PiB2b2lkKSA9PiBmbigpKTtcclxufVxyXG5cclxucHJvY2Vzcy5vbignZXhpdCcsIGNsb3NlRGF0YWJhc2UpO1xyXG5wcm9jZXNzLm9uKCdTSUdJTlQnLCBjbG9zZURhdGFiYXNlKTtcclxucHJvY2Vzcy5vbignU0lHVEVSTScsIGNsb3NlRGF0YWJhc2UpOyJdLCJuYW1lcyI6WyJEYXRhYmFzZSIsIkRBVEFCQVNFX0NPTkZJRyIsInBhdGgiLCJkYiIsImdldERhdGFiYXNlIiwiZGJQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJGSUxFTkFNRSIsInZlcmJvc2UiLCJjb25zb2xlIiwibG9nIiwidW5kZWZpbmVkIiwidGltZW91dCIsIlRJTUVPVVQiLCJwcmFnbWEiLCJpbml0aWFsaXplVGFibGVzIiwiY3JlYXRlVXNlcnNUYWJsZSIsImNyZWF0ZVBhc3N3b3Jkc1RhYmxlIiwiY3JlYXRlVXNlcnNFbWFpbEluZGV4IiwiY3JlYXRlUGFzc3dvcmRzVXNlcklkSW5kZXgiLCJjcmVhdGVQYXNzd29yZHNTZXJ2aWNlSW5kZXgiLCJleGVjIiwiY2xvc2VEYXRhYmFzZSIsImNsb3NlIiwiYmVnaW5UcmFuc2FjdGlvbiIsInRyYW5zYWN0aW9uIiwiZm4iLCJvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/database/connection.ts\n");

/***/ }),

/***/ "(rsc)/./lib/database/models.ts":
/*!********************************!*\
  !*** ./lib/database/models.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PasswordModel: () => (/* binding */ PasswordModel),\n/* harmony export */   UserModel: () => (/* binding */ UserModel)\n/* harmony export */ });\n/* harmony import */ var _connection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./connection */ \"(rsc)/./lib/database/connection.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n\n\nclass UserModel {\n    static create(data) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const id = (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n        const now = new Date();\n        const stmt = db.prepare(`\r\n      INSERT INTO users (id, email, master_password_hash, salt, created_at, updated_at)\r\n      VALUES (?, ?, ?, ?, ?, ?)\r\n    `);\n        stmt.run(id, data.email, data.masterPasswordHash, data.salt, now.toISOString(), now.toISOString());\n        return {\n            id,\n            email: data.email,\n            masterPasswordHash: data.masterPasswordHash,\n            salt: data.salt,\n            createdAt: now,\n            updatedAt: now\n        };\n    }\n    static findByEmail(email) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const stmt = db.prepare(`\r\n      SELECT id, email, master_password_hash, salt, created_at, updated_at\r\n      FROM users WHERE email = ?\r\n    `);\n        const row = stmt.get(email);\n        if (!row) return null;\n        return {\n            id: row.id,\n            email: row.email,\n            masterPasswordHash: row.master_password_hash,\n            salt: row.salt,\n            createdAt: new Date(row.created_at),\n            updatedAt: new Date(row.updated_at)\n        };\n    }\n    static findById(id) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const stmt = db.prepare(`\r\n      SELECT id, email, master_password_hash, salt, created_at, updated_at\r\n      FROM users WHERE id = ?\r\n    `);\n        const row = stmt.get(id);\n        if (!row) return null;\n        return {\n            id: row.id,\n            email: row.email,\n            masterPasswordHash: row.master_password_hash,\n            salt: row.salt,\n            createdAt: new Date(row.created_at),\n            updatedAt: new Date(row.updated_at)\n        };\n    }\n}\nclass PasswordModel {\n    static create(userId, data, encryptedData) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const id = (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n        const now = new Date();\n        const stmt = db.prepare(`\r\n      INSERT INTO passwords (id, user_id, service, username, encrypted_password, iv, url, notes, created_at, updated_at)\r\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n    `);\n        stmt.run(id, userId, data.service, data.username, encryptedData.encryptedPassword, encryptedData.iv, data.url || null, data.notes || null, now.toISOString(), now.toISOString());\n        return {\n            id,\n            userId,\n            service: data.service,\n            username: data.username,\n            encryptedPassword: encryptedData.encryptedPassword,\n            iv: encryptedData.iv,\n            url: data.url,\n            notes: data.notes,\n            createdAt: now,\n            updatedAt: now\n        };\n    }\n    static findByUserId(userId) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const stmt = db.prepare(`\r\n      SELECT id, user_id, service, username, encrypted_password, iv, url, notes, created_at, updated_at\r\n      FROM passwords WHERE user_id = ?\r\n      ORDER BY created_at DESC\r\n    `);\n        const rows = stmt.all(userId);\n        return rows.map((row)=>({\n                id: row.id,\n                userId: row.user_id,\n                service: row.service,\n                username: row.username,\n                encryptedPassword: row.encrypted_password,\n                iv: row.iv,\n                url: row.url,\n                notes: row.notes,\n                createdAt: new Date(row.created_at),\n                updatedAt: new Date(row.updated_at)\n            }));\n    }\n    static findById(id, userId) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const stmt = db.prepare(`\r\n      SELECT id, user_id, service, username, encrypted_password, iv, url, notes, created_at, updated_at\r\n      FROM passwords WHERE id = ? AND user_id = ?\r\n    `);\n        const row = stmt.get(id, userId);\n        if (!row) return null;\n        return {\n            id: row.id,\n            userId: row.user_id,\n            service: row.service,\n            username: row.username,\n            encryptedPassword: row.encrypted_password,\n            iv: row.iv,\n            url: row.url,\n            notes: row.notes,\n            createdAt: new Date(row.created_at),\n            updatedAt: new Date(row.updated_at)\n        };\n    }\n    static update(id, userId, data, encryptedData) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const updates = [];\n        const values = [];\n        if (data.service) {\n            updates.push(\"service = ?\");\n            values.push(data.service);\n        }\n        if (data.username) {\n            updates.push(\"username = ?\");\n            values.push(data.username);\n        }\n        if (encryptedData) {\n            updates.push(\"encrypted_password = ?, iv = ?\");\n            values.push(encryptedData.encryptedPassword, encryptedData.iv);\n        }\n        if (data.url !== undefined) {\n            updates.push(\"url = ?\");\n            values.push(data.url || null);\n        }\n        if (data.notes !== undefined) {\n            updates.push(\"notes = ?\");\n            values.push(data.notes || null);\n        }\n        updates.push(\"updated_at = ?\");\n        values.push(new Date().toISOString());\n        values.push(id, userId);\n        const stmt = db.prepare(`\r\n      UPDATE passwords SET ${updates.join(\", \")}\r\n      WHERE id = ? AND user_id = ?\r\n    `);\n        const result = stmt.run(...values);\n        return result.changes > 0;\n    }\n    static delete(id, userId) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const stmt = db.prepare(\"DELETE FROM passwords WHERE id = ? AND user_id = ?\");\n        const result = stmt.run(id, userId);\n        return result.changes > 0;\n    }\n    static search(userId, query) {\n        const db = (0,_connection__WEBPACK_IMPORTED_MODULE_0__.getDatabase)();\n        const stmt = db.prepare(`\r\n      SELECT id, user_id, service, username, encrypted_password, iv, url, notes, created_at, updated_at\r\n      FROM passwords \r\n      WHERE user_id = ? AND (\r\n        service LIKE ? OR \r\n        username LIKE ? OR \r\n        url LIKE ? OR \r\n        notes LIKE ?\r\n      )\r\n      ORDER BY created_at DESC\r\n    `);\n        const searchPattern = `%${query}%`;\n        const rows = stmt.all(userId, searchPattern, searchPattern, searchPattern, searchPattern);\n        return rows.map((row)=>({\n                id: row.id,\n                userId: row.user_id,\n                service: row.service,\n                username: row.username,\n                encryptedPassword: row.encrypted_password,\n                iv: row.iv,\n                url: row.url,\n                notes: row.notes,\n                createdAt: new Date(row.created_at),\n                updatedAt: new Date(row.updated_at)\n            }));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGF0YWJhc2UvbW9kZWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBMkM7QUFFUDtBQUU3QixNQUFNRztJQUNYLE9BQU9DLE9BQU9DLElBSWIsRUFBUTtRQUNQLE1BQU1DLEtBQUtOLHdEQUFXQTtRQUN0QixNQUFNTyxLQUFLTCxnREFBTUE7UUFDakIsTUFBTU0sTUFBTSxJQUFJQztRQUVoQixNQUFNQyxPQUFPSixHQUFHSyxPQUFPLENBQUMsQ0FBQzs7O0lBR3pCLENBQUM7UUFFREQsS0FBS0UsR0FBRyxDQUFDTCxJQUFJRixLQUFLUSxLQUFLLEVBQUVSLEtBQUtTLGtCQUFrQixFQUFFVCxLQUFLVSxJQUFJLEVBQUVQLElBQUlRLFdBQVcsSUFBSVIsSUFBSVEsV0FBVztRQUUvRixPQUFPO1lBQ0xUO1lBQ0FNLE9BQU9SLEtBQUtRLEtBQUs7WUFDakJDLG9CQUFvQlQsS0FBS1Msa0JBQWtCO1lBQzNDQyxNQUFNVixLQUFLVSxJQUFJO1lBQ2ZFLFdBQVdUO1lBQ1hVLFdBQVdWO1FBQ2I7SUFDRjtJQUVBLE9BQU9XLFlBQVlOLEtBQWEsRUFBZTtRQUM3QyxNQUFNUCxLQUFLTix3REFBV0E7UUFDdEIsTUFBTVUsT0FBT0osR0FBR0ssT0FBTyxDQUFDLENBQUM7OztJQUd6QixDQUFDO1FBRUQsTUFBTVMsTUFBTVYsS0FBS1csR0FBRyxDQUFDUjtRQUNyQixJQUFJLENBQUNPLEtBQUssT0FBTztRQUVqQixPQUFPO1lBQ0xiLElBQUlhLElBQUliLEVBQUU7WUFDVk0sT0FBT08sSUFBSVAsS0FBSztZQUNoQkMsb0JBQW9CTSxJQUFJRSxvQkFBb0I7WUFDNUNQLE1BQU1LLElBQUlMLElBQUk7WUFDZEUsV0FBVyxJQUFJUixLQUFLVyxJQUFJRyxVQUFVO1lBQ2xDTCxXQUFXLElBQUlULEtBQUtXLElBQUlJLFVBQVU7UUFDcEM7SUFDRjtJQUVBLE9BQU9DLFNBQVNsQixFQUFVLEVBQWU7UUFDdkMsTUFBTUQsS0FBS04sd0RBQVdBO1FBQ3RCLE1BQU1VLE9BQU9KLEdBQUdLLE9BQU8sQ0FBQyxDQUFDOzs7SUFHekIsQ0FBQztRQUVELE1BQU1TLE1BQU1WLEtBQUtXLEdBQUcsQ0FBQ2Q7UUFDckIsSUFBSSxDQUFDYSxLQUFLLE9BQU87UUFFakIsT0FBTztZQUNMYixJQUFJYSxJQUFJYixFQUFFO1lBQ1ZNLE9BQU9PLElBQUlQLEtBQUs7WUFDaEJDLG9CQUFvQk0sSUFBSUUsb0JBQW9CO1lBQzVDUCxNQUFNSyxJQUFJTCxJQUFJO1lBQ2RFLFdBQVcsSUFBSVIsS0FBS1csSUFBSUcsVUFBVTtZQUNsQ0wsV0FBVyxJQUFJVCxLQUFLVyxJQUFJSSxVQUFVO1FBQ3BDO0lBQ0Y7QUFDRjtBQUVPLE1BQU1FO0lBQ1gsT0FBT3RCLE9BQU91QixNQUFjLEVBQUV0QixJQUEyQixFQUFFdUIsYUFHMUQsRUFBWTtRQUNYLE1BQU10QixLQUFLTix3REFBV0E7UUFDdEIsTUFBTU8sS0FBS0wsZ0RBQU1BO1FBQ2pCLE1BQU1NLE1BQU0sSUFBSUM7UUFFaEIsTUFBTUMsT0FBT0osR0FBR0ssT0FBTyxDQUFDLENBQUM7OztJQUd6QixDQUFDO1FBRURELEtBQUtFLEdBQUcsQ0FDTkwsSUFDQW9CLFFBQ0F0QixLQUFLd0IsT0FBTyxFQUNaeEIsS0FBS3lCLFFBQVEsRUFDYkYsY0FBY0csaUJBQWlCLEVBQy9CSCxjQUFjSSxFQUFFLEVBQ2hCM0IsS0FBSzRCLEdBQUcsSUFBSSxNQUNaNUIsS0FBSzZCLEtBQUssSUFBSSxNQUNkMUIsSUFBSVEsV0FBVyxJQUNmUixJQUFJUSxXQUFXO1FBR2pCLE9BQU87WUFDTFQ7WUFDQW9CO1lBQ0FFLFNBQVN4QixLQUFLd0IsT0FBTztZQUNyQkMsVUFBVXpCLEtBQUt5QixRQUFRO1lBQ3ZCQyxtQkFBbUJILGNBQWNHLGlCQUFpQjtZQUNsREMsSUFBSUosY0FBY0ksRUFBRTtZQUNwQkMsS0FBSzVCLEtBQUs0QixHQUFHO1lBQ2JDLE9BQU83QixLQUFLNkIsS0FBSztZQUNqQmpCLFdBQVdUO1lBQ1hVLFdBQVdWO1FBQ2I7SUFDRjtJQUVBLE9BQU8yQixhQUFhUixNQUFjLEVBQWM7UUFDOUMsTUFBTXJCLEtBQUtOLHdEQUFXQTtRQUN0QixNQUFNVSxPQUFPSixHQUFHSyxPQUFPLENBQUMsQ0FBQzs7OztJQUl6QixDQUFDO1FBRUQsTUFBTXlCLE9BQU8xQixLQUFLMkIsR0FBRyxDQUFDVjtRQUV0QixPQUFPUyxLQUFLRSxHQUFHLENBQUNsQixDQUFBQSxNQUFRO2dCQUN0QmIsSUFBSWEsSUFBSWIsRUFBRTtnQkFDVm9CLFFBQVFQLElBQUltQixPQUFPO2dCQUNuQlYsU0FBU1QsSUFBSVMsT0FBTztnQkFDcEJDLFVBQVVWLElBQUlVLFFBQVE7Z0JBQ3RCQyxtQkFBbUJYLElBQUlvQixrQkFBa0I7Z0JBQ3pDUixJQUFJWixJQUFJWSxFQUFFO2dCQUNWQyxLQUFLYixJQUFJYSxHQUFHO2dCQUNaQyxPQUFPZCxJQUFJYyxLQUFLO2dCQUNoQmpCLFdBQVcsSUFBSVIsS0FBS1csSUFBSUcsVUFBVTtnQkFDbENMLFdBQVcsSUFBSVQsS0FBS1csSUFBSUksVUFBVTtZQUNwQztJQUNGO0lBRUEsT0FBT0MsU0FBU2xCLEVBQVUsRUFBRW9CLE1BQWMsRUFBbUI7UUFDM0QsTUFBTXJCLEtBQUtOLHdEQUFXQTtRQUN0QixNQUFNVSxPQUFPSixHQUFHSyxPQUFPLENBQUMsQ0FBQzs7O0lBR3pCLENBQUM7UUFFRCxNQUFNUyxNQUFNVixLQUFLVyxHQUFHLENBQUNkLElBQUlvQjtRQUN6QixJQUFJLENBQUNQLEtBQUssT0FBTztRQUVqQixPQUFPO1lBQ0xiLElBQUlhLElBQUliLEVBQUU7WUFDVm9CLFFBQVFQLElBQUltQixPQUFPO1lBQ25CVixTQUFTVCxJQUFJUyxPQUFPO1lBQ3BCQyxVQUFVVixJQUFJVSxRQUFRO1lBQ3RCQyxtQkFBbUJYLElBQUlvQixrQkFBa0I7WUFDekNSLElBQUlaLElBQUlZLEVBQUU7WUFDVkMsS0FBS2IsSUFBSWEsR0FBRztZQUNaQyxPQUFPZCxJQUFJYyxLQUFLO1lBQ2hCakIsV0FBVyxJQUFJUixLQUFLVyxJQUFJRyxVQUFVO1lBQ2xDTCxXQUFXLElBQUlULEtBQUtXLElBQUlJLFVBQVU7UUFDcEM7SUFDRjtJQUVBLE9BQU9pQixPQUFPbEMsRUFBVSxFQUFFb0IsTUFBYyxFQUFFdEIsSUFBb0MsRUFBRXVCLGFBRy9FLEVBQVc7UUFDVixNQUFNdEIsS0FBS04sd0RBQVdBO1FBQ3RCLE1BQU0wQyxVQUFvQixFQUFFO1FBQzVCLE1BQU1DLFNBQWdCLEVBQUU7UUFFeEIsSUFBSXRDLEtBQUt3QixPQUFPLEVBQUU7WUFDaEJhLFFBQVFFLElBQUksQ0FBQztZQUNiRCxPQUFPQyxJQUFJLENBQUN2QyxLQUFLd0IsT0FBTztRQUMxQjtRQUVBLElBQUl4QixLQUFLeUIsUUFBUSxFQUFFO1lBQ2pCWSxRQUFRRSxJQUFJLENBQUM7WUFDYkQsT0FBT0MsSUFBSSxDQUFDdkMsS0FBS3lCLFFBQVE7UUFDM0I7UUFFQSxJQUFJRixlQUFlO1lBQ2pCYyxRQUFRRSxJQUFJLENBQUM7WUFDYkQsT0FBT0MsSUFBSSxDQUFDaEIsY0FBY0csaUJBQWlCLEVBQUVILGNBQWNJLEVBQUU7UUFDL0Q7UUFFQSxJQUFJM0IsS0FBSzRCLEdBQUcsS0FBS1ksV0FBVztZQUMxQkgsUUFBUUUsSUFBSSxDQUFDO1lBQ2JELE9BQU9DLElBQUksQ0FBQ3ZDLEtBQUs0QixHQUFHLElBQUk7UUFDMUI7UUFFQSxJQUFJNUIsS0FBSzZCLEtBQUssS0FBS1csV0FBVztZQUM1QkgsUUFBUUUsSUFBSSxDQUFDO1lBQ2JELE9BQU9DLElBQUksQ0FBQ3ZDLEtBQUs2QixLQUFLLElBQUk7UUFDNUI7UUFFQVEsUUFBUUUsSUFBSSxDQUFDO1FBQ2JELE9BQU9DLElBQUksQ0FBQyxJQUFJbkMsT0FBT08sV0FBVztRQUVsQzJCLE9BQU9DLElBQUksQ0FBQ3JDLElBQUlvQjtRQUVoQixNQUFNakIsT0FBT0osR0FBR0ssT0FBTyxDQUFDLENBQUM7MkJBQ0YsRUFBRStCLFFBQVFJLElBQUksQ0FBQyxNQUFNOztJQUU1QyxDQUFDO1FBRUQsTUFBTUMsU0FBU3JDLEtBQUtFLEdBQUcsSUFBSStCO1FBQzNCLE9BQU9JLE9BQU9DLE9BQU8sR0FBRztJQUMxQjtJQUVBLE9BQU9DLE9BQU8xQyxFQUFVLEVBQUVvQixNQUFjLEVBQVc7UUFDakQsTUFBTXJCLEtBQUtOLHdEQUFXQTtRQUN0QixNQUFNVSxPQUFPSixHQUFHSyxPQUFPLENBQUM7UUFDeEIsTUFBTW9DLFNBQVNyQyxLQUFLRSxHQUFHLENBQUNMLElBQUlvQjtRQUM1QixPQUFPb0IsT0FBT0MsT0FBTyxHQUFHO0lBQzFCO0lBRUEsT0FBT0UsT0FBT3ZCLE1BQWMsRUFBRXdCLEtBQWEsRUFBYztRQUN2RCxNQUFNN0MsS0FBS04sd0RBQVdBO1FBQ3RCLE1BQU1VLE9BQU9KLEdBQUdLLE9BQU8sQ0FBQyxDQUFDOzs7Ozs7Ozs7O0lBVXpCLENBQUM7UUFFRCxNQUFNeUMsZ0JBQWdCLENBQUMsQ0FBQyxFQUFFRCxNQUFNLENBQUMsQ0FBQztRQUNsQyxNQUFNZixPQUFPMUIsS0FBSzJCLEdBQUcsQ0FBQ1YsUUFBUXlCLGVBQWVBLGVBQWVBLGVBQWVBO1FBRTNFLE9BQU9oQixLQUFLRSxHQUFHLENBQUNsQixDQUFBQSxNQUFRO2dCQUN0QmIsSUFBSWEsSUFBSWIsRUFBRTtnQkFDVm9CLFFBQVFQLElBQUltQixPQUFPO2dCQUNuQlYsU0FBU1QsSUFBSVMsT0FBTztnQkFDcEJDLFVBQVVWLElBQUlVLFFBQVE7Z0JBQ3RCQyxtQkFBbUJYLElBQUlvQixrQkFBa0I7Z0JBQ3pDUixJQUFJWixJQUFJWSxFQUFFO2dCQUNWQyxLQUFLYixJQUFJYSxHQUFHO2dCQUNaQyxPQUFPZCxJQUFJYyxLQUFLO2dCQUNoQmpCLFdBQVcsSUFBSVIsS0FBS1csSUFBSUcsVUFBVTtnQkFDbENMLFdBQVcsSUFBSVQsS0FBS1csSUFBSUksVUFBVTtZQUNwQztJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZXN0b3ItY29udHJhc2VuYXMtc2VndXJvLy4vbGliL2RhdGFiYXNlL21vZGVscy50cz85MmI1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldERhdGFiYXNlIH0gZnJvbSAnLi9jb25uZWN0aW9uJztcclxuaW1wb3J0IHR5cGUgeyBVc2VyLCBQYXNzd29yZCwgQ3JlYXRlUGFzc3dvcmRSZXF1ZXN0LCBVcGRhdGVQYXNzd29yZFJlcXVlc3QgfSBmcm9tICcuLi90eXBlcyc7XHJcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFVzZXJNb2RlbCB7XHJcbiAgc3RhdGljIGNyZWF0ZShkYXRhOiB7XHJcbiAgICBlbWFpbDogc3RyaW5nO1xyXG4gICAgbWFzdGVyUGFzc3dvcmRIYXNoOiBzdHJpbmc7XHJcbiAgICBzYWx0OiBzdHJpbmc7XHJcbiAgfSk6IFVzZXIge1xyXG4gICAgY29uc3QgZGIgPSBnZXREYXRhYmFzZSgpO1xyXG4gICAgY29uc3QgaWQgPSB1dWlkdjQoKTtcclxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcclxuICAgICAgSU5TRVJUIElOVE8gdXNlcnMgKGlkLCBlbWFpbCwgbWFzdGVyX3Bhc3N3b3JkX2hhc2gsIHNhbHQsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQpXHJcbiAgICAgIFZBTFVFUyAoPywgPywgPywgPywgPywgPylcclxuICAgIGApO1xyXG4gICAgXHJcbiAgICBzdG10LnJ1bihpZCwgZGF0YS5lbWFpbCwgZGF0YS5tYXN0ZXJQYXNzd29yZEhhc2gsIGRhdGEuc2FsdCwgbm93LnRvSVNPU3RyaW5nKCksIG5vdy50b0lTT1N0cmluZygpKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaWQsXHJcbiAgICAgIGVtYWlsOiBkYXRhLmVtYWlsLFxyXG4gICAgICBtYXN0ZXJQYXNzd29yZEhhc2g6IGRhdGEubWFzdGVyUGFzc3dvcmRIYXNoLFxyXG4gICAgICBzYWx0OiBkYXRhLnNhbHQsXHJcbiAgICAgIGNyZWF0ZWRBdDogbm93LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5vdyxcclxuICAgIH07XHJcbiAgfVxyXG4gIFxyXG4gIHN0YXRpYyBmaW5kQnlFbWFpbChlbWFpbDogc3RyaW5nKTogVXNlciB8IG51bGwge1xyXG4gICAgY29uc3QgZGIgPSBnZXREYXRhYmFzZSgpO1xyXG4gICAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoYFxyXG4gICAgICBTRUxFQ1QgaWQsIGVtYWlsLCBtYXN0ZXJfcGFzc3dvcmRfaGFzaCwgc2FsdCwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdFxyXG4gICAgICBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gP1xyXG4gICAgYCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHJvdyA9IHN0bXQuZ2V0KGVtYWlsKSBhcyBhbnk7XHJcbiAgICBpZiAoIXJvdykgcmV0dXJuIG51bGw7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByb3cuaWQsXHJcbiAgICAgIGVtYWlsOiByb3cuZW1haWwsXHJcbiAgICAgIG1hc3RlclBhc3N3b3JkSGFzaDogcm93Lm1hc3Rlcl9wYXNzd29yZF9oYXNoLFxyXG4gICAgICBzYWx0OiByb3cuc2FsdCxcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShyb3cuY3JlYXRlZF9hdCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUocm93LnVwZGF0ZWRfYXQpLFxyXG4gICAgfTtcclxuICB9XHJcbiAgXHJcbiAgc3RhdGljIGZpbmRCeUlkKGlkOiBzdHJpbmcpOiBVc2VyIHwgbnVsbCB7XHJcbiAgICBjb25zdCBkYiA9IGdldERhdGFiYXNlKCk7XHJcbiAgICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShgXHJcbiAgICAgIFNFTEVDVCBpZCwgZW1haWwsIG1hc3Rlcl9wYXNzd29yZF9oYXNoLCBzYWx0LCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0XHJcbiAgICAgIEZST00gdXNlcnMgV0hFUkUgaWQgPSA/XHJcbiAgICBgKTtcclxuICAgIFxyXG4gICAgY29uc3Qgcm93ID0gc3RtdC5nZXQoaWQpIGFzIGFueTtcclxuICAgIGlmICghcm93KSByZXR1cm4gbnVsbDtcclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaWQ6IHJvdy5pZCxcclxuICAgICAgZW1haWw6IHJvdy5lbWFpbCxcclxuICAgICAgbWFzdGVyUGFzc3dvcmRIYXNoOiByb3cubWFzdGVyX3Bhc3N3b3JkX2hhc2gsXHJcbiAgICAgIHNhbHQ6IHJvdy5zYWx0LFxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKHJvdy5jcmVhdGVkX2F0KSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZShyb3cudXBkYXRlZF9hdCksXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFBhc3N3b3JkTW9kZWwge1xyXG4gIHN0YXRpYyBjcmVhdGUodXNlcklkOiBzdHJpbmcsIGRhdGE6IENyZWF0ZVBhc3N3b3JkUmVxdWVzdCwgZW5jcnlwdGVkRGF0YToge1xyXG4gICAgZW5jcnlwdGVkUGFzc3dvcmQ6IHN0cmluZztcclxuICAgIGl2OiBzdHJpbmc7XHJcbiAgfSk6IFBhc3N3b3JkIHtcclxuICAgIGNvbnN0IGRiID0gZ2V0RGF0YWJhc2UoKTtcclxuICAgIGNvbnN0IGlkID0gdXVpZHY0KCk7XHJcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgXHJcbiAgICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShgXHJcbiAgICAgIElOU0VSVCBJTlRPIHBhc3N3b3JkcyAoaWQsIHVzZXJfaWQsIHNlcnZpY2UsIHVzZXJuYW1lLCBlbmNyeXB0ZWRfcGFzc3dvcmQsIGl2LCB1cmwsIG5vdGVzLCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0KVxyXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sID8sID8sID8pXHJcbiAgICBgKTtcclxuICAgIFxyXG4gICAgc3RtdC5ydW4oXHJcbiAgICAgIGlkLFxyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIGRhdGEuc2VydmljZSxcclxuICAgICAgZGF0YS51c2VybmFtZSxcclxuICAgICAgZW5jcnlwdGVkRGF0YS5lbmNyeXB0ZWRQYXNzd29yZCxcclxuICAgICAgZW5jcnlwdGVkRGF0YS5pdixcclxuICAgICAgZGF0YS51cmwgfHwgbnVsbCxcclxuICAgICAgZGF0YS5ub3RlcyB8fCBudWxsLFxyXG4gICAgICBub3cudG9JU09TdHJpbmcoKSxcclxuICAgICAgbm93LnRvSVNPU3RyaW5nKClcclxuICAgICk7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkLFxyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIHNlcnZpY2U6IGRhdGEuc2VydmljZSxcclxuICAgICAgdXNlcm5hbWU6IGRhdGEudXNlcm5hbWUsXHJcbiAgICAgIGVuY3J5cHRlZFBhc3N3b3JkOiBlbmNyeXB0ZWREYXRhLmVuY3J5cHRlZFBhc3N3b3JkLFxyXG4gICAgICBpdjogZW5jcnlwdGVkRGF0YS5pdixcclxuICAgICAgdXJsOiBkYXRhLnVybCxcclxuICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgIGNyZWF0ZWRBdDogbm93LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5vdyxcclxuICAgIH07XHJcbiAgfVxyXG4gIFxyXG4gIHN0YXRpYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcpOiBQYXNzd29yZFtdIHtcclxuICAgIGNvbnN0IGRiID0gZ2V0RGF0YWJhc2UoKTtcclxuICAgIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcclxuICAgICAgU0VMRUNUIGlkLCB1c2VyX2lkLCBzZXJ2aWNlLCB1c2VybmFtZSwgZW5jcnlwdGVkX3Bhc3N3b3JkLCBpdiwgdXJsLCBub3RlcywgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdFxyXG4gICAgICBGUk9NIHBhc3N3b3JkcyBXSEVSRSB1c2VyX2lkID0gP1xyXG4gICAgICBPUkRFUiBCWSBjcmVhdGVkX2F0IERFU0NcclxuICAgIGApO1xyXG4gICAgXHJcbiAgICBjb25zdCByb3dzID0gc3RtdC5hbGwodXNlcklkKSBhcyBhbnlbXTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHJvd3MubWFwKHJvdyA9PiAoe1xyXG4gICAgICBpZDogcm93LmlkLFxyXG4gICAgICB1c2VySWQ6IHJvdy51c2VyX2lkLFxyXG4gICAgICBzZXJ2aWNlOiByb3cuc2VydmljZSxcclxuICAgICAgdXNlcm5hbWU6IHJvdy51c2VybmFtZSxcclxuICAgICAgZW5jcnlwdGVkUGFzc3dvcmQ6IHJvdy5lbmNyeXB0ZWRfcGFzc3dvcmQsXHJcbiAgICAgIGl2OiByb3cuaXYsXHJcbiAgICAgIHVybDogcm93LnVybCxcclxuICAgICAgbm90ZXM6IHJvdy5ub3RlcyxcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShyb3cuY3JlYXRlZF9hdCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUocm93LnVwZGF0ZWRfYXQpLFxyXG4gICAgfSkpO1xyXG4gIH1cclxuICBcclxuICBzdGF0aWMgZmluZEJ5SWQoaWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpOiBQYXNzd29yZCB8IG51bGwge1xyXG4gICAgY29uc3QgZGIgPSBnZXREYXRhYmFzZSgpO1xyXG4gICAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoYFxyXG4gICAgICBTRUxFQ1QgaWQsIHVzZXJfaWQsIHNlcnZpY2UsIHVzZXJuYW1lLCBlbmNyeXB0ZWRfcGFzc3dvcmQsIGl2LCB1cmwsIG5vdGVzLCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0XHJcbiAgICAgIEZST00gcGFzc3dvcmRzIFdIRVJFIGlkID0gPyBBTkQgdXNlcl9pZCA9ID9cclxuICAgIGApO1xyXG4gICAgXHJcbiAgICBjb25zdCByb3cgPSBzdG10LmdldChpZCwgdXNlcklkKSBhcyBhbnk7XHJcbiAgICBpZiAoIXJvdykgcmV0dXJuIG51bGw7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByb3cuaWQsXHJcbiAgICAgIHVzZXJJZDogcm93LnVzZXJfaWQsXHJcbiAgICAgIHNlcnZpY2U6IHJvdy5zZXJ2aWNlLFxyXG4gICAgICB1c2VybmFtZTogcm93LnVzZXJuYW1lLFxyXG4gICAgICBlbmNyeXB0ZWRQYXNzd29yZDogcm93LmVuY3J5cHRlZF9wYXNzd29yZCxcclxuICAgICAgaXY6IHJvdy5pdixcclxuICAgICAgdXJsOiByb3cudXJsLFxyXG4gICAgICBub3Rlczogcm93Lm5vdGVzLFxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKHJvdy5jcmVhdGVkX2F0KSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZShyb3cudXBkYXRlZF9hdCksXHJcbiAgICB9O1xyXG4gIH1cclxuICBcclxuICBzdGF0aWMgdXBkYXRlKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBQYXJ0aWFsPFVwZGF0ZVBhc3N3b3JkUmVxdWVzdD4sIGVuY3J5cHRlZERhdGE/OiB7XHJcbiAgICBlbmNyeXB0ZWRQYXNzd29yZDogc3RyaW5nO1xyXG4gICAgaXY6IHN0cmluZztcclxuICB9KTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBkYiA9IGdldERhdGFiYXNlKCk7XHJcbiAgICBjb25zdCB1cGRhdGVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtdO1xyXG4gICAgXHJcbiAgICBpZiAoZGF0YS5zZXJ2aWNlKSB7XHJcbiAgICAgIHVwZGF0ZXMucHVzaCgnc2VydmljZSA9ID8nKTtcclxuICAgICAgdmFsdWVzLnB1c2goZGF0YS5zZXJ2aWNlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKGRhdGEudXNlcm5hbWUpIHtcclxuICAgICAgdXBkYXRlcy5wdXNoKCd1c2VybmFtZSA9ID8nKTtcclxuICAgICAgdmFsdWVzLnB1c2goZGF0YS51c2VybmFtZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChlbmNyeXB0ZWREYXRhKSB7XHJcbiAgICAgIHVwZGF0ZXMucHVzaCgnZW5jcnlwdGVkX3Bhc3N3b3JkID0gPywgaXYgPSA/Jyk7XHJcbiAgICAgIHZhbHVlcy5wdXNoKGVuY3J5cHRlZERhdGEuZW5jcnlwdGVkUGFzc3dvcmQsIGVuY3J5cHRlZERhdGEuaXYpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoZGF0YS51cmwgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVzLnB1c2goJ3VybCA9ID8nKTtcclxuICAgICAgdmFsdWVzLnB1c2goZGF0YS51cmwgfHwgbnVsbCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChkYXRhLm5vdGVzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlcy5wdXNoKCdub3RlcyA9ID8nKTtcclxuICAgICAgdmFsdWVzLnB1c2goZGF0YS5ub3RlcyB8fCBudWxsKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgdXBkYXRlcy5wdXNoKCd1cGRhdGVkX2F0ID0gPycpO1xyXG4gICAgdmFsdWVzLnB1c2gobmV3IERhdGUoKS50b0lTT1N0cmluZygpKTtcclxuICAgIFxyXG4gICAgdmFsdWVzLnB1c2goaWQsIHVzZXJJZCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcclxuICAgICAgVVBEQVRFIHBhc3N3b3JkcyBTRVQgJHt1cGRhdGVzLmpvaW4oJywgJyl9XHJcbiAgICAgIFdIRVJFIGlkID0gPyBBTkQgdXNlcl9pZCA9ID9cclxuICAgIGApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSBzdG10LnJ1biguLi52YWx1ZXMpO1xyXG4gICAgcmV0dXJuIHJlc3VsdC5jaGFuZ2VzID4gMDtcclxuICB9XHJcbiAgXHJcbiAgc3RhdGljIGRlbGV0ZShpZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgZGIgPSBnZXREYXRhYmFzZSgpO1xyXG4gICAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoJ0RFTEVURSBGUk9NIHBhc3N3b3JkcyBXSEVSRSBpZCA9ID8gQU5EIHVzZXJfaWQgPSA/Jyk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBzdG10LnJ1bihpZCwgdXNlcklkKTtcclxuICAgIHJldHVybiByZXN1bHQuY2hhbmdlcyA+IDA7XHJcbiAgfVxyXG4gIFxyXG4gIHN0YXRpYyBzZWFyY2godXNlcklkOiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcpOiBQYXNzd29yZFtdIHtcclxuICAgIGNvbnN0IGRiID0gZ2V0RGF0YWJhc2UoKTtcclxuICAgIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcclxuICAgICAgU0VMRUNUIGlkLCB1c2VyX2lkLCBzZXJ2aWNlLCB1c2VybmFtZSwgZW5jcnlwdGVkX3Bhc3N3b3JkLCBpdiwgdXJsLCBub3RlcywgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdFxyXG4gICAgICBGUk9NIHBhc3N3b3JkcyBcclxuICAgICAgV0hFUkUgdXNlcl9pZCA9ID8gQU5EIChcclxuICAgICAgICBzZXJ2aWNlIExJS0UgPyBPUiBcclxuICAgICAgICB1c2VybmFtZSBMSUtFID8gT1IgXHJcbiAgICAgICAgdXJsIExJS0UgPyBPUiBcclxuICAgICAgICBub3RlcyBMSUtFID9cclxuICAgICAgKVxyXG4gICAgICBPUkRFUiBCWSBjcmVhdGVkX2F0IERFU0NcclxuICAgIGApO1xyXG4gICAgXHJcbiAgICBjb25zdCBzZWFyY2hQYXR0ZXJuID0gYCUke3F1ZXJ5fSVgO1xyXG4gICAgY29uc3Qgcm93cyA9IHN0bXQuYWxsKHVzZXJJZCwgc2VhcmNoUGF0dGVybiwgc2VhcmNoUGF0dGVybiwgc2VhcmNoUGF0dGVybiwgc2VhcmNoUGF0dGVybikgYXMgYW55W107XHJcbiAgICBcclxuICAgIHJldHVybiByb3dzLm1hcChyb3cgPT4gKHtcclxuICAgICAgaWQ6IHJvdy5pZCxcclxuICAgICAgdXNlcklkOiByb3cudXNlcl9pZCxcclxuICAgICAgc2VydmljZTogcm93LnNlcnZpY2UsXHJcbiAgICAgIHVzZXJuYW1lOiByb3cudXNlcm5hbWUsXHJcbiAgICAgIGVuY3J5cHRlZFBhc3N3b3JkOiByb3cuZW5jcnlwdGVkX3Bhc3N3b3JkLFxyXG4gICAgICBpdjogcm93Lml2LFxyXG4gICAgICB1cmw6IHJvdy51cmwsXHJcbiAgICAgIG5vdGVzOiByb3cubm90ZXMsXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUocm93LmNyZWF0ZWRfYXQpLFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKHJvdy51cGRhdGVkX2F0KSxcclxuICAgIH0pKTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiZ2V0RGF0YWJhc2UiLCJ2NCIsInV1aWR2NCIsIlVzZXJNb2RlbCIsImNyZWF0ZSIsImRhdGEiLCJkYiIsImlkIiwibm93IiwiRGF0ZSIsInN0bXQiLCJwcmVwYXJlIiwicnVuIiwiZW1haWwiLCJtYXN0ZXJQYXNzd29yZEhhc2giLCJzYWx0IiwidG9JU09TdHJpbmciLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJmaW5kQnlFbWFpbCIsInJvdyIsImdldCIsIm1hc3Rlcl9wYXNzd29yZF9oYXNoIiwiY3JlYXRlZF9hdCIsInVwZGF0ZWRfYXQiLCJmaW5kQnlJZCIsIlBhc3N3b3JkTW9kZWwiLCJ1c2VySWQiLCJlbmNyeXB0ZWREYXRhIiwic2VydmljZSIsInVzZXJuYW1lIiwiZW5jcnlwdGVkUGFzc3dvcmQiLCJpdiIsInVybCIsIm5vdGVzIiwiZmluZEJ5VXNlcklkIiwicm93cyIsImFsbCIsIm1hcCIsInVzZXJfaWQiLCJlbmNyeXB0ZWRfcGFzc3dvcmQiLCJ1cGRhdGUiLCJ1cGRhdGVzIiwidmFsdWVzIiwicHVzaCIsInVuZGVmaW5lZCIsImpvaW4iLCJyZXN1bHQiLCJjaGFuZ2VzIiwiZGVsZXRlIiwic2VhcmNoIiwicXVlcnkiLCJzZWFyY2hQYXR0ZXJuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/database/models.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/constants.ts":
/*!********************************!*\
  !*** ./lib/utils/constants.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   API_ROUTES: () => (/* binding */ API_ROUTES),\n/* harmony export */   CHARACTER_SETS: () => (/* binding */ CHARACTER_SETS),\n/* harmony export */   DATABASE_CONFIG: () => (/* binding */ DATABASE_CONFIG),\n/* harmony export */   ENCRYPTION_CONFIG: () => (/* binding */ ENCRYPTION_CONFIG),\n/* harmony export */   JWT_CONFIG: () => (/* binding */ JWT_CONFIG),\n/* harmony export */   PASSWORD_CONFIG: () => (/* binding */ PASSWORD_CONFIG),\n/* harmony export */   PASSWORD_GENERATOR_PRESETS: () => (/* binding */ PASSWORD_GENERATOR_PRESETS),\n/* harmony export */   ROUTES: () => (/* binding */ ROUTES),\n/* harmony export */   UI_CONFIG: () => (/* binding */ UI_CONFIG),\n/* harmony export */   VALIDATION_MESSAGES: () => (/* binding */ VALIDATION_MESSAGES)\n/* harmony export */ });\nconst ENCRYPTION_CONFIG = {\n    ALGORITHM: \"aes-256-gcm\",\n    KEY_LENGTH: 32,\n    IV_LENGTH: 16,\n    TAG_LENGTH: 16,\n    SALT_LENGTH: 32\n};\nconst PASSWORD_CONFIG = {\n    MIN_LENGTH: 8,\n    MAX_LENGTH: 128,\n    BCRYPT_ROUNDS: 12,\n    DEFAULT_GENERATED_LENGTH: 16\n};\nconst JWT_CONFIG = {\n    SECRET_MIN_LENGTH: 32,\n    EXPIRES_IN: \"24h\",\n    ALGORITHM: \"HS256\"\n};\nconst DATABASE_CONFIG = {\n    FILENAME: \"passwords.db\",\n    TIMEOUT: 5000,\n    BACKUP_INTERVAL: 24 * 60 * 60 * 1000\n};\nconst VALIDATION_MESSAGES = {\n    EMAIL_REQUIRED: \"Email es requerido\",\n    EMAIL_INVALID: \"Formato de email inv\\xe1lido\",\n    PASSWORD_REQUIRED: \"Contrase\\xf1a es requerida\",\n    PASSWORD_MIN_LENGTH: `Contrasea debe tener al menos ${PASSWORD_CONFIG.MIN_LENGTH} caracteres`,\n    PASSWORD_MAX_LENGTH: `Contrasea debe tener mximo ${PASSWORD_CONFIG.MAX_LENGTH} caracteres`,\n    SERVICE_REQUIRED: \"Servicio es requerido\",\n    USERNAME_REQUIRED: \"Usuario es requerido\",\n    MASTER_PASSWORD_REQUIRED: \"Contrase\\xf1a maestra es requerida\",\n    PASSWORDS_DONT_MATCH: \"Las contrase\\xf1as no coinciden\",\n    INVALID_CREDENTIALS: \"Credenciales inv\\xe1lidas\",\n    USER_EXISTS: \"El usuario ya existe\",\n    USER_NOT_FOUND: \"Usuario no encontrado\",\n    UNAUTHORIZED: \"No autorizado\",\n    SERVER_ERROR: \"Error del servidor\",\n    PASSWORD_NOT_FOUND: \"Contrase\\xf1a no encontrada\"\n};\nconst UI_CONFIG = {\n    ITEMS_PER_PAGE: 10,\n    SEARCH_DEBOUNCE: 300,\n    TOAST_DURATION: 3000,\n    MODAL_ANIMATION_DURATION: 200\n};\nconst PASSWORD_GENERATOR_PRESETS = {\n    WEAK: {\n        length: 8,\n        includeUppercase: true,\n        includeLowercase: true,\n        includeNumbers: false,\n        includeSymbols: false,\n        excludeSimilar: false\n    },\n    MEDIUM: {\n        length: 12,\n        includeUppercase: true,\n        includeLowercase: true,\n        includeNumbers: true,\n        includeSymbols: false,\n        excludeSimilar: true\n    },\n    STRONG: {\n        length: 16,\n        includeUppercase: true,\n        includeLowercase: true,\n        includeNumbers: true,\n        includeSymbols: true,\n        excludeSimilar: true\n    },\n    PARANOID: {\n        length: 32,\n        includeUppercase: true,\n        includeLowercase: true,\n        includeNumbers: true,\n        includeSymbols: true,\n        excludeSimilar: true\n    }\n};\nconst CHARACTER_SETS = {\n    UPPERCASE: \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\",\n    LOWERCASE: \"abcdefghijklmnopqrstuvwxyz\",\n    NUMBERS: \"0123456789\",\n    SYMBOLS: \"!@#$%^&*()_+-=[]{}|;:,.<>?\",\n    SIMILAR: \"il1Lo0O\"\n};\nconst API_ROUTES = {\n    AUTH: {\n        LOGIN: \"/api/auth/login\",\n        REGISTER: \"/api/auth/register\"\n    },\n    PASSWORDS: {\n        BASE: \"/api/passwords\",\n        BY_ID: (id)=>`/api/passwords/${id}`\n    }\n};\nconst ROUTES = {\n    HOME: \"/\",\n    LOGIN: \"/login\",\n    REGISTER: \"/register\",\n    DASHBOARD: \"/dashboard\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdXRpbHMvY29uc3RhbnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBTyxNQUFNQSxvQkFBb0I7SUFDL0JDLFdBQVc7SUFDWEMsWUFBWTtJQUNaQyxXQUFXO0lBQ1hDLFlBQVk7SUFDWkMsYUFBYTtBQUNmLEVBQVc7QUFFSixNQUFNQyxrQkFBa0I7SUFDN0JDLFlBQVk7SUFDWkMsWUFBWTtJQUNaQyxlQUFlO0lBQ2ZDLDBCQUEwQjtBQUM1QixFQUFXO0FBRUosTUFBTUMsYUFBYTtJQUN4QkMsbUJBQW1CO0lBQ25CQyxZQUFZO0lBQ1paLFdBQVc7QUFDYixFQUFXO0FBRUosTUFBTWEsa0JBQWtCO0lBQzdCQyxVQUFVO0lBQ1ZDLFNBQVM7SUFDVEMsaUJBQWlCLEtBQUssS0FBSyxLQUFLO0FBQ2xDLEVBQVc7QUFFSixNQUFNQyxzQkFBc0I7SUFDakNDLGdCQUFnQjtJQUNoQkMsZUFBZTtJQUNmQyxtQkFBbUI7SUFDbkJDLHFCQUFxQixDQUFDLCtCQUErQixFQUFFaEIsZ0JBQWdCQyxVQUFVLENBQUMsV0FBVyxDQUFDO0lBQzlGZ0IscUJBQXFCLENBQUMsNkJBQTZCLEVBQUVqQixnQkFBZ0JFLFVBQVUsQ0FBQyxXQUFXLENBQUM7SUFDNUZnQixrQkFBa0I7SUFDbEJDLG1CQUFtQjtJQUNuQkMsMEJBQTBCO0lBQzFCQyxzQkFBc0I7SUFDdEJDLHFCQUFxQjtJQUNyQkMsYUFBYTtJQUNiQyxnQkFBZ0I7SUFDaEJDLGNBQWM7SUFDZEMsY0FBYztJQUNkQyxvQkFBb0I7QUFDdEIsRUFBVztBQUVKLE1BQU1DLFlBQVk7SUFDdkJDLGdCQUFnQjtJQUNoQkMsaUJBQWlCO0lBQ2pCQyxnQkFBZ0I7SUFDaEJDLDBCQUEwQjtBQUM1QixFQUFXO0FBRUosTUFBTUMsNkJBQTZCO0lBQ3hDQyxNQUFNO1FBQ0pDLFFBQVE7UUFDUkMsa0JBQWtCO1FBQ2xCQyxrQkFBa0I7UUFDbEJDLGdCQUFnQjtRQUNoQkMsZ0JBQWdCO1FBQ2hCQyxnQkFBZ0I7SUFDbEI7SUFDQUMsUUFBUTtRQUNOTixRQUFRO1FBQ1JDLGtCQUFrQjtRQUNsQkMsa0JBQWtCO1FBQ2xCQyxnQkFBZ0I7UUFDaEJDLGdCQUFnQjtRQUNoQkMsZ0JBQWdCO0lBQ2xCO0lBQ0FFLFFBQVE7UUFDTlAsUUFBUTtRQUNSQyxrQkFBa0I7UUFDbEJDLGtCQUFrQjtRQUNsQkMsZ0JBQWdCO1FBQ2hCQyxnQkFBZ0I7UUFDaEJDLGdCQUFnQjtJQUNsQjtJQUNBRyxVQUFVO1FBQ1JSLFFBQVE7UUFDUkMsa0JBQWtCO1FBQ2xCQyxrQkFBa0I7UUFDbEJDLGdCQUFnQjtRQUNoQkMsZ0JBQWdCO1FBQ2hCQyxnQkFBZ0I7SUFDbEI7QUFDRixFQUFXO0FBRUosTUFBTUksaUJBQWlCO0lBQzVCQyxXQUFXO0lBQ1hDLFdBQVc7SUFDWEMsU0FBUztJQUNUQyxTQUFTO0lBQ1RDLFNBQVM7QUFDWCxFQUFXO0FBRUosTUFBTUMsYUFBYTtJQUN4QkMsTUFBTTtRQUNKQyxPQUFPO1FBQ1BDLFVBQVU7SUFDWjtJQUNBQyxXQUFXO1FBQ1RDLE1BQU07UUFDTkMsT0FBTyxDQUFDQyxLQUFlLENBQUMsZUFBZSxFQUFFQSxHQUFHLENBQUM7SUFDL0M7QUFDRixFQUFXO0FBRUosTUFBTUMsU0FBUztJQUNwQkMsTUFBTTtJQUNOUCxPQUFPO0lBQ1BDLFVBQVU7SUFDVk8sV0FBVztBQUNiLEVBQVciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZXN0b3ItY29udHJhc2VuYXMtc2VndXJvLy4vbGliL3V0aWxzL2NvbnN0YW50cy50cz8wNjRiIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBFTkNSWVBUSU9OX0NPTkZJRyA9IHtcclxuICBBTEdPUklUSE06ICdhZXMtMjU2LWdjbScsXHJcbiAgS0VZX0xFTkdUSDogMzIsXHJcbiAgSVZfTEVOR1RIOiAxNixcclxuICBUQUdfTEVOR1RIOiAxNixcclxuICBTQUxUX0xFTkdUSDogMzIsXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgUEFTU1dPUkRfQ09ORklHID0ge1xyXG4gIE1JTl9MRU5HVEg6IDgsXHJcbiAgTUFYX0xFTkdUSDogMTI4LFxyXG4gIEJDUllQVF9ST1VORFM6IDEyLFxyXG4gIERFRkFVTFRfR0VORVJBVEVEX0xFTkdUSDogMTYsXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgSldUX0NPTkZJRyA9IHtcclxuICBTRUNSRVRfTUlOX0xFTkdUSDogMzIsXHJcbiAgRVhQSVJFU19JTjogJzI0aCcsXHJcbiAgQUxHT1JJVEhNOiAnSFMyNTYnLFxyXG59IGFzIGNvbnN0O1xyXG5cclxuZXhwb3J0IGNvbnN0IERBVEFCQVNFX0NPTkZJRyA9IHtcclxuICBGSUxFTkFNRTogJ3Bhc3N3b3Jkcy5kYicsXHJcbiAgVElNRU9VVDogNTAwMCxcclxuICBCQUNLVVBfSU5URVJWQUw6IDI0ICogNjAgKiA2MCAqIDEwMDAsXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgVkFMSURBVElPTl9NRVNTQUdFUyA9IHtcclxuICBFTUFJTF9SRVFVSVJFRDogJ0VtYWlsIGVzIHJlcXVlcmlkbycsXHJcbiAgRU1BSUxfSU5WQUxJRDogJ0Zvcm1hdG8gZGUgZW1haWwgaW52w6FsaWRvJyxcclxuICBQQVNTV09SRF9SRVFVSVJFRDogJ0NvbnRyYXNlw7FhIGVzIHJlcXVlcmlkYScsXHJcbiAgUEFTU1dPUkRfTUlOX0xFTkdUSDogYENvbnRyYXNlw7FhIGRlYmUgdGVuZXIgYWwgbWVub3MgJHtQQVNTV09SRF9DT05GSUcuTUlOX0xFTkdUSH0gY2FyYWN0ZXJlc2AsXHJcbiAgUEFTU1dPUkRfTUFYX0xFTkdUSDogYENvbnRyYXNlw7FhIGRlYmUgdGVuZXIgbcOheGltbyAke1BBU1NXT1JEX0NPTkZJRy5NQVhfTEVOR1RIfSBjYXJhY3RlcmVzYCxcclxuICBTRVJWSUNFX1JFUVVJUkVEOiAnU2VydmljaW8gZXMgcmVxdWVyaWRvJyxcclxuICBVU0VSTkFNRV9SRVFVSVJFRDogJ1VzdWFyaW8gZXMgcmVxdWVyaWRvJyxcclxuICBNQVNURVJfUEFTU1dPUkRfUkVRVUlSRUQ6ICdDb250cmFzZcOxYSBtYWVzdHJhIGVzIHJlcXVlcmlkYScsXHJcbiAgUEFTU1dPUkRTX0RPTlRfTUFUQ0g6ICdMYXMgY29udHJhc2XDsWFzIG5vIGNvaW5jaWRlbicsXHJcbiAgSU5WQUxJRF9DUkVERU5USUFMUzogJ0NyZWRlbmNpYWxlcyBpbnbDoWxpZGFzJyxcclxuICBVU0VSX0VYSVNUUzogJ0VsIHVzdWFyaW8geWEgZXhpc3RlJyxcclxuICBVU0VSX05PVF9GT1VORDogJ1VzdWFyaW8gbm8gZW5jb250cmFkbycsXHJcbiAgVU5BVVRIT1JJWkVEOiAnTm8gYXV0b3JpemFkbycsXHJcbiAgU0VSVkVSX0VSUk9SOiAnRXJyb3IgZGVsIHNlcnZpZG9yJyxcclxuICBQQVNTV09SRF9OT1RfRk9VTkQ6ICdDb250cmFzZcOxYSBubyBlbmNvbnRyYWRhJyxcclxufSBhcyBjb25zdDtcclxuXHJcbmV4cG9ydCBjb25zdCBVSV9DT05GSUcgPSB7XHJcbiAgSVRFTVNfUEVSX1BBR0U6IDEwLFxyXG4gIFNFQVJDSF9ERUJPVU5DRTogMzAwLFxyXG4gIFRPQVNUX0RVUkFUSU9OOiAzMDAwLFxyXG4gIE1PREFMX0FOSU1BVElPTl9EVVJBVElPTjogMjAwLFxyXG59IGFzIGNvbnN0O1xyXG5cclxuZXhwb3J0IGNvbnN0IFBBU1NXT1JEX0dFTkVSQVRPUl9QUkVTRVRTID0ge1xyXG4gIFdFQUs6IHtcclxuICAgIGxlbmd0aDogOCxcclxuICAgIGluY2x1ZGVVcHBlcmNhc2U6IHRydWUsXHJcbiAgICBpbmNsdWRlTG93ZXJjYXNlOiB0cnVlLFxyXG4gICAgaW5jbHVkZU51bWJlcnM6IGZhbHNlLFxyXG4gICAgaW5jbHVkZVN5bWJvbHM6IGZhbHNlLFxyXG4gICAgZXhjbHVkZVNpbWlsYXI6IGZhbHNlLFxyXG4gIH0sXHJcbiAgTUVESVVNOiB7XHJcbiAgICBsZW5ndGg6IDEyLFxyXG4gICAgaW5jbHVkZVVwcGVyY2FzZTogdHJ1ZSxcclxuICAgIGluY2x1ZGVMb3dlcmNhc2U6IHRydWUsXHJcbiAgICBpbmNsdWRlTnVtYmVyczogdHJ1ZSxcclxuICAgIGluY2x1ZGVTeW1ib2xzOiBmYWxzZSxcclxuICAgIGV4Y2x1ZGVTaW1pbGFyOiB0cnVlLFxyXG4gIH0sXHJcbiAgU1RST05HOiB7XHJcbiAgICBsZW5ndGg6IDE2LFxyXG4gICAgaW5jbHVkZVVwcGVyY2FzZTogdHJ1ZSxcclxuICAgIGluY2x1ZGVMb3dlcmNhc2U6IHRydWUsXHJcbiAgICBpbmNsdWRlTnVtYmVyczogdHJ1ZSxcclxuICAgIGluY2x1ZGVTeW1ib2xzOiB0cnVlLFxyXG4gICAgZXhjbHVkZVNpbWlsYXI6IHRydWUsXHJcbiAgfSxcclxuICBQQVJBTk9JRDoge1xyXG4gICAgbGVuZ3RoOiAzMixcclxuICAgIGluY2x1ZGVVcHBlcmNhc2U6IHRydWUsXHJcbiAgICBpbmNsdWRlTG93ZXJjYXNlOiB0cnVlLFxyXG4gICAgaW5jbHVkZU51bWJlcnM6IHRydWUsXHJcbiAgICBpbmNsdWRlU3ltYm9sczogdHJ1ZSxcclxuICAgIGV4Y2x1ZGVTaW1pbGFyOiB0cnVlLFxyXG4gIH0sXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgQ0hBUkFDVEVSX1NFVFMgPSB7XHJcbiAgVVBQRVJDQVNFOiAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonLFxyXG4gIExPV0VSQ0FTRTogJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JyxcclxuICBOVU1CRVJTOiAnMDEyMzQ1Njc4OScsXHJcbiAgU1lNQk9MUzogJyFAIyQlXiYqKClfKy09W117fXw7OiwuPD4/JyxcclxuICBTSU1JTEFSOiAnaWwxTG8wTycsXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgQVBJX1JPVVRFUyA9IHtcclxuICBBVVRIOiB7XHJcbiAgICBMT0dJTjogJy9hcGkvYXV0aC9sb2dpbicsXHJcbiAgICBSRUdJU1RFUjogJy9hcGkvYXV0aC9yZWdpc3RlcicsXHJcbiAgfSxcclxuICBQQVNTV09SRFM6IHtcclxuICAgIEJBU0U6ICcvYXBpL3Bhc3N3b3JkcycsXHJcbiAgICBCWV9JRDogKGlkOiBzdHJpbmcpID0+IGAvYXBpL3Bhc3N3b3Jkcy8ke2lkfWAsXHJcbiAgfSxcclxufSBhcyBjb25zdDtcclxuXHJcbmV4cG9ydCBjb25zdCBST1VURVMgPSB7XHJcbiAgSE9NRTogJy8nLFxyXG4gIExPR0lOOiAnL2xvZ2luJyxcclxuICBSRUdJU1RFUjogJy9yZWdpc3RlcicsXHJcbiAgREFTSEJPQVJEOiAnL2Rhc2hib2FyZCcsXHJcbn0gYXMgY29uc3Q7Il0sIm5hbWVzIjpbIkVOQ1JZUFRJT05fQ09ORklHIiwiQUxHT1JJVEhNIiwiS0VZX0xFTkdUSCIsIklWX0xFTkdUSCIsIlRBR19MRU5HVEgiLCJTQUxUX0xFTkdUSCIsIlBBU1NXT1JEX0NPTkZJRyIsIk1JTl9MRU5HVEgiLCJNQVhfTEVOR1RIIiwiQkNSWVBUX1JPVU5EUyIsIkRFRkFVTFRfR0VORVJBVEVEX0xFTkdUSCIsIkpXVF9DT05GSUciLCJTRUNSRVRfTUlOX0xFTkdUSCIsIkVYUElSRVNfSU4iLCJEQVRBQkFTRV9DT05GSUciLCJGSUxFTkFNRSIsIlRJTUVPVVQiLCJCQUNLVVBfSU5URVJWQUwiLCJWQUxJREFUSU9OX01FU1NBR0VTIiwiRU1BSUxfUkVRVUlSRUQiLCJFTUFJTF9JTlZBTElEIiwiUEFTU1dPUkRfUkVRVUlSRUQiLCJQQVNTV09SRF9NSU5fTEVOR1RIIiwiUEFTU1dPUkRfTUFYX0xFTkdUSCIsIlNFUlZJQ0VfUkVRVUlSRUQiLCJVU0VSTkFNRV9SRVFVSVJFRCIsIk1BU1RFUl9QQVNTV09SRF9SRVFVSVJFRCIsIlBBU1NXT1JEU19ET05UX01BVENIIiwiSU5WQUxJRF9DUkVERU5USUFMUyIsIlVTRVJfRVhJU1RTIiwiVVNFUl9OT1RfRk9VTkQiLCJVTkFVVEhPUklaRUQiLCJTRVJWRVJfRVJST1IiLCJQQVNTV09SRF9OT1RfRk9VTkQiLCJVSV9DT05GSUciLCJJVEVNU19QRVJfUEFHRSIsIlNFQVJDSF9ERUJPVU5DRSIsIlRPQVNUX0RVUkFUSU9OIiwiTU9EQUxfQU5JTUFUSU9OX0RVUkFUSU9OIiwiUEFTU1dPUkRfR0VORVJBVE9SX1BSRVNFVFMiLCJXRUFLIiwibGVuZ3RoIiwiaW5jbHVkZVVwcGVyY2FzZSIsImluY2x1ZGVMb3dlcmNhc2UiLCJpbmNsdWRlTnVtYmVycyIsImluY2x1ZGVTeW1ib2xzIiwiZXhjbHVkZVNpbWlsYXIiLCJNRURJVU0iLCJTVFJPTkciLCJQQVJBTk9JRCIsIkNIQVJBQ1RFUl9TRVRTIiwiVVBQRVJDQVNFIiwiTE9XRVJDQVNFIiwiTlVNQkVSUyIsIlNZTUJPTFMiLCJTSU1JTEFSIiwiQVBJX1JPVVRFUyIsIkFVVEgiLCJMT0dJTiIsIlJFR0lTVEVSIiwiUEFTU1dPUkRTIiwiQkFTRSIsIkJZX0lEIiwiaWQiLCJST1VURVMiLCJIT01FIiwiREFTSEJPQVJEIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/constants.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/validation.ts":
/*!*********************************!*\
  !*** ./lib/utils/validation.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createPasswordSchema: () => (/* binding */ createPasswordSchema),\n/* harmony export */   emailSchema: () => (/* binding */ emailSchema),\n/* harmony export */   generatePasswordSchema: () => (/* binding */ generatePasswordSchema),\n/* harmony export */   isValidEmail: () => (/* binding */ isValidEmail),\n/* harmony export */   isValidUUID: () => (/* binding */ isValidUUID),\n/* harmony export */   loginSchema: () => (/* binding */ loginSchema),\n/* harmony export */   masterPasswordSchema: () => (/* binding */ masterPasswordSchema),\n/* harmony export */   passwordSchema: () => (/* binding */ passwordSchema),\n/* harmony export */   registerSchema: () => (/* binding */ registerSchema),\n/* harmony export */   sanitizeInput: () => (/* binding */ sanitizeInput),\n/* harmony export */   updatePasswordSchema: () => (/* binding */ updatePasswordSchema),\n/* harmony export */   validateGeneratorOptions: () => (/* binding */ validateGeneratorOptions),\n/* harmony export */   validatePassword: () => (/* binding */ validatePassword)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ \"(rsc)/./lib/utils/constants.ts\");\n\n\nconst emailSchema = zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1, _constants__WEBPACK_IMPORTED_MODULE_0__.VALIDATION_MESSAGES.EMAIL_REQUIRED).email(_constants__WEBPACK_IMPORTED_MODULE_0__.VALIDATION_MESSAGES.EMAIL_INVALID);\nconst passwordSchema = zod__WEBPACK_IMPORTED_MODULE_1__.string().min(_constants__WEBPACK_IMPORTED_MODULE_0__.PASSWORD_CONFIG.MIN_LENGTH, _constants__WEBPACK_IMPORTED_MODULE_0__.VALIDATION_MESSAGES.PASSWORD_MIN_LENGTH).max(_constants__WEBPACK_IMPORTED_MODULE_0__.PASSWORD_CONFIG.MAX_LENGTH, _constants__WEBPACK_IMPORTED_MODULE_0__.VALIDATION_MESSAGES.PASSWORD_MAX_LENGTH);\nconst masterPasswordSchema = zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1, _constants__WEBPACK_IMPORTED_MODULE_0__.VALIDATION_MESSAGES.MASTER_PASSWORD_REQUIRED).min(_constants__WEBPACK_IMPORTED_MODULE_0__.PASSWORD_CONFIG.MIN_LENGTH, _constants__WEBPACK_IMPORTED_MODULE_0__.VALIDATION_MESSAGES.PASSWORD_MIN_LENGTH);\nconst loginSchema = zod__WEBPACK_IMPORTED_MODULE_1__.object({\n    email: emailSchema,\n    masterPassword: masterPasswordSchema\n});\nconst registerSchema = zod__WEBPACK_IMPORTED_MODULE_1__.object({\n    email: emailSchema,\n    masterPassword: masterPasswordSchema\n});\nconst createPasswordSchema = zod__WEBPACK_IMPORTED_MODULE_1__.object({\n    service: zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1, _constants__WEBPACK_IMPORTED_MODULE_0__.VALIDATION_MESSAGES.SERVICE_REQUIRED),\n    username: zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1, _constants__WEBPACK_IMPORTED_MODULE_0__.VALIDATION_MESSAGES.USERNAME_REQUIRED),\n    password: passwordSchema,\n    url: zod__WEBPACK_IMPORTED_MODULE_1__.string().url().optional().or(zod__WEBPACK_IMPORTED_MODULE_1__.literal(\"\")),\n    notes: zod__WEBPACK_IMPORTED_MODULE_1__.string().max(500).optional()\n});\nconst updatePasswordSchema = zod__WEBPACK_IMPORTED_MODULE_1__.object({\n    id: zod__WEBPACK_IMPORTED_MODULE_1__.string().uuid(),\n    service: zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1).optional(),\n    username: zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1).optional(),\n    password: passwordSchema.optional(),\n    url: zod__WEBPACK_IMPORTED_MODULE_1__.string().url().optional().or(zod__WEBPACK_IMPORTED_MODULE_1__.literal(\"\")),\n    notes: zod__WEBPACK_IMPORTED_MODULE_1__.string().max(500).optional()\n});\nconst generatePasswordSchema = zod__WEBPACK_IMPORTED_MODULE_1__.object({\n    length: zod__WEBPACK_IMPORTED_MODULE_1__.number().min(4).max(128),\n    includeUppercase: zod__WEBPACK_IMPORTED_MODULE_1__.boolean(),\n    includeLowercase: zod__WEBPACK_IMPORTED_MODULE_1__.boolean(),\n    includeNumbers: zod__WEBPACK_IMPORTED_MODULE_1__.boolean(),\n    includeSymbols: zod__WEBPACK_IMPORTED_MODULE_1__.boolean(),\n    excludeSimilar: zod__WEBPACK_IMPORTED_MODULE_1__.boolean()\n});\nfunction validatePassword(password) {\n    const requirements = {\n        length: password.length >= _constants__WEBPACK_IMPORTED_MODULE_0__.PASSWORD_CONFIG.MIN_LENGTH,\n        uppercase: /[A-Z]/.test(password),\n        lowercase: /[a-z]/.test(password),\n        numbers: /\\d/.test(password),\n        symbols: /[!@#$%^&*()_+\\-=\\[\\]{}|;:,.<>?]/.test(password)\n    };\n    const metRequirements = Object.values(requirements).filter(Boolean).length;\n    let score = 0;\n    const feedback = [];\n    if (requirements.length) score += 1;\n    else feedback.push(\"Debe tener al menos 8 caracteres\");\n    if (requirements.uppercase) score += 1;\n    else feedback.push(\"Debe incluir al menos una may\\xfascula\");\n    if (requirements.lowercase) score += 1;\n    else feedback.push(\"Debe incluir al menos una min\\xfascula\");\n    if (requirements.numbers) score += 1;\n    else feedback.push(\"Debe incluir al menos un n\\xfamero\");\n    if (requirements.symbols) score += 1;\n    else feedback.push(\"Debe incluir al menos un s\\xedmbolo\");\n    if (password.length >= 12) score += 1;\n    if (password.length >= 16) score += 1;\n    return {\n        score: Math.min(score, 5),\n        feedback,\n        requirements\n    };\n}\nfunction sanitizeInput(input) {\n    return input.trim().replace(/[<>]/g, \"\");\n}\nfunction isValidUUID(uuid) {\n    const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n    return uuidRegex.test(uuid);\n}\nfunction isValidEmail(email) {\n    try {\n        emailSchema.parse(email);\n        return true;\n    } catch  {\n        return false;\n    }\n}\nfunction validateGeneratorOptions(options) {\n    try {\n        generatePasswordSchema.parse(options);\n        return options.includeUppercase || options.includeLowercase || options.includeNumbers || options.includeSymbols;\n    } catch  {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YnBhY2s6Ly9nZXN0b3ItY29udHJhc2VuYXMtc2VndXJvLy4vbGliL3V0aWxzL3ZhbGlkYXRpb24udHM/ZDgyNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcclxuaW1wb3J0IHsgVkFMSURBVElPTl9NRVNTQUdFUywgUEFTU1dPUkRfQ09ORklHIH0gZnJvbSAnLi9jb25zdGFudHMnO1xyXG5pbXBvcnQgdHlwZSB7IFBhc3N3b3JkU3RyZW5ndGgsIEdlbmVyYXRlUGFzc3dvcmRPcHRpb25zIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVtYWlsU2NoZW1hID0gelxyXG4gIC5zdHJpbmcoKVxyXG4gIC5taW4oMSwgVkFMSURBVElPTl9NRVNTQUdFUy5FTUFJTF9SRVFVSVJFRClcclxuICAuZW1haWwoVkFMSURBVElPTl9NRVNTQUdFUy5FTUFJTF9JTlZBTElEKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwYXNzd29yZFNjaGVtYSA9IHpcclxuICAuc3RyaW5nKClcclxuICAubWluKFBBU1NXT1JEX0NPTkZJRy5NSU5fTEVOR1RILCBWQUxJREFUSU9OX01FU1NBR0VTLlBBU1NXT1JEX01JTl9MRU5HVEgpXHJcbiAgLm1heChQQVNTV09SRF9DT05GSUcuTUFYX0xFTkdUSCwgVkFMSURBVElPTl9NRVNTQUdFUy5QQVNTV09SRF9NQVhfTEVOR1RIKTtcclxuXHJcbmV4cG9ydCBjb25zdCBtYXN0ZXJQYXNzd29yZFNjaGVtYSA9IHpcclxuICAuc3RyaW5nKClcclxuICAubWluKDEsIFZBTElEQVRJT05fTUVTU0FHRVMuTUFTVEVSX1BBU1NXT1JEX1JFUVVJUkVEKVxyXG4gIC5taW4oUEFTU1dPUkRfQ09ORklHLk1JTl9MRU5HVEgsIFZBTElEQVRJT05fTUVTU0FHRVMuUEFTU1dPUkRfTUlOX0xFTkdUSCk7XHJcblxyXG5leHBvcnQgY29uc3QgbG9naW5TY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgZW1haWw6IGVtYWlsU2NoZW1hLFxyXG4gIG1hc3RlclBhc3N3b3JkOiBtYXN0ZXJQYXNzd29yZFNjaGVtYSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgcmVnaXN0ZXJTY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgZW1haWw6IGVtYWlsU2NoZW1hLFxyXG4gIG1hc3RlclBhc3N3b3JkOiBtYXN0ZXJQYXNzd29yZFNjaGVtYSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlUGFzc3dvcmRTY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgc2VydmljZTogei5zdHJpbmcoKS5taW4oMSwgVkFMSURBVElPTl9NRVNTQUdFUy5TRVJWSUNFX1JFUVVJUkVEKSxcclxuICB1c2VybmFtZTogei5zdHJpbmcoKS5taW4oMSwgVkFMSURBVElPTl9NRVNTQUdFUy5VU0VSTkFNRV9SRVFVSVJFRCksXHJcbiAgcGFzc3dvcmQ6IHBhc3N3b3JkU2NoZW1hLFxyXG4gIHVybDogei5zdHJpbmcoKS51cmwoKS5vcHRpb25hbCgpLm9yKHoubGl0ZXJhbCgnJykpLFxyXG4gIG5vdGVzOiB6LnN0cmluZygpLm1heCg1MDApLm9wdGlvbmFsKCksXHJcbn0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IHVwZGF0ZVBhc3N3b3JkU2NoZW1hID0gei5vYmplY3Qoe1xyXG4gIGlkOiB6LnN0cmluZygpLnV1aWQoKSxcclxuICBzZXJ2aWNlOiB6LnN0cmluZygpLm1pbigxKS5vcHRpb25hbCgpLFxyXG4gIHVzZXJuYW1lOiB6LnN0cmluZygpLm1pbigxKS5vcHRpb25hbCgpLFxyXG4gIHBhc3N3b3JkOiBwYXNzd29yZFNjaGVtYS5vcHRpb25hbCgpLFxyXG4gIHVybDogei5zdHJpbmcoKS51cmwoKS5vcHRpb25hbCgpLm9yKHoubGl0ZXJhbCgnJykpLFxyXG4gIG5vdGVzOiB6LnN0cmluZygpLm1heCg1MDApLm9wdGlvbmFsKCksXHJcbn0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlUGFzc3dvcmRTY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgbGVuZ3RoOiB6Lm51bWJlcigpLm1pbig0KS5tYXgoMTI4KSxcclxuICBpbmNsdWRlVXBwZXJjYXNlOiB6LmJvb2xlYW4oKSxcclxuICBpbmNsdWRlTG93ZXJjYXNlOiB6LmJvb2xlYW4oKSxcclxuICBpbmNsdWRlTnVtYmVyczogei5ib29sZWFuKCksXHJcbiAgaW5jbHVkZVN5bWJvbHM6IHouYm9vbGVhbigpLFxyXG4gIGV4Y2x1ZGVTaW1pbGFyOiB6LmJvb2xlYW4oKSxcclxufSkgc2F0aXNmaWVzIHouWm9kU2NoZW1hPEdlbmVyYXRlUGFzc3dvcmRPcHRpb25zPjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpOiBQYXNzd29yZFN0cmVuZ3RoIHtcclxuICBjb25zdCByZXF1aXJlbWVudHMgPSB7XHJcbiAgICBsZW5ndGg6IHBhc3N3b3JkLmxlbmd0aCA+PSBQQVNTV09SRF9DT05GSUcuTUlOX0xFTkdUSCxcclxuICAgIHVwcGVyY2FzZTogL1tBLVpdLy50ZXN0KHBhc3N3b3JkKSxcclxuICAgIGxvd2VyY2FzZTogL1thLXpdLy50ZXN0KHBhc3N3b3JkKSxcclxuICAgIG51bWJlcnM6IC9cXGQvLnRlc3QocGFzc3dvcmQpLFxyXG4gICAgc3ltYm9sczogL1shQCMkJV4mKigpXytcXC09XFxbXFxde318OzosLjw+P10vLnRlc3QocGFzc3dvcmQpLFxyXG4gIH07XHJcblxyXG4gIGNvbnN0IG1ldFJlcXVpcmVtZW50cyA9IE9iamVjdC52YWx1ZXMocmVxdWlyZW1lbnRzKS5maWx0ZXIoQm9vbGVhbikubGVuZ3RoO1xyXG4gIGxldCBzY29yZSA9IDA7XHJcbiAgY29uc3QgZmVlZGJhY2s6IHN0cmluZ1tdID0gW107XHJcblxyXG4gIGlmIChyZXF1aXJlbWVudHMubGVuZ3RoKSBzY29yZSArPSAxO1xyXG4gIGVsc2UgZmVlZGJhY2sucHVzaCgnRGViZSB0ZW5lciBhbCBtZW5vcyA4IGNhcmFjdGVyZXMnKTtcclxuXHJcbiAgaWYgKHJlcXVpcmVtZW50cy51cHBlcmNhc2UpIHNjb3JlICs9IDE7XHJcbiAgZWxzZSBmZWVkYmFjay5wdXNoKCdEZWJlIGluY2x1aXIgYWwgbWVub3MgdW5hIG1hecO6c2N1bGEnKTtcclxuXHJcbiAgaWYgKHJlcXVpcmVtZW50cy5sb3dlcmNhc2UpIHNjb3JlICs9IDE7XHJcbiAgZWxzZSBmZWVkYmFjay5wdXNoKCdEZWJlIGluY2x1aXIgYWwgbWVub3MgdW5hIG1pbsO6c2N1bGEnKTtcclxuXHJcbiAgaWYgKHJlcXVpcmVtZW50cy5udW1iZXJzKSBzY29yZSArPSAxO1xyXG4gIGVsc2UgZmVlZGJhY2sucHVzaCgnRGViZSBpbmNsdWlyIGFsIG1lbm9zIHVuIG7Dum1lcm8nKTtcclxuXHJcbiAgaWYgKHJlcXVpcmVtZW50cy5zeW1ib2xzKSBzY29yZSArPSAxO1xyXG4gIGVsc2UgZmVlZGJhY2sucHVzaCgnRGViZSBpbmNsdWlyIGFsIG1lbm9zIHVuIHPDrW1ib2xvJyk7XHJcblxyXG4gIGlmIChwYXNzd29yZC5sZW5ndGggPj0gMTIpIHNjb3JlICs9IDE7XHJcbiAgaWYgKHBhc3N3b3JkLmxlbmd0aCA+PSAxNikgc2NvcmUgKz0gMTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHNjb3JlOiBNYXRoLm1pbihzY29yZSwgNSksXHJcbiAgICBmZWVkYmFjayxcclxuICAgIHJlcXVpcmVtZW50cyxcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVJbnB1dChpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gaW5wdXQudHJpbSgpLnJlcGxhY2UoL1s8Pl0vZywgJycpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZFVVSUQodXVpZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgY29uc3QgdXVpZFJlZ2V4ID0gL15bMC05YS1mXXs4fS1bMC05YS1mXXs0fS00WzAtOWEtZl17M30tWzg5YWJdWzAtOWEtZl17M30tWzAtOWEtZl17MTJ9JC9pO1xyXG4gIHJldHVybiB1dWlkUmVnZXgudGVzdCh1dWlkKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRFbWFpbChlbWFpbDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgdHJ5IHtcclxuICAgIGVtYWlsU2NoZW1hLnBhcnNlKGVtYWlsKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2gge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlR2VuZXJhdG9yT3B0aW9ucyhvcHRpb25zOiBHZW5lcmF0ZVBhc3N3b3JkT3B0aW9ucyk6IGJvb2xlYW4ge1xyXG4gIHRyeSB7XHJcbiAgICBnZW5lcmF0ZVBhc3N3b3JkU2NoZW1hLnBhcnNlKG9wdGlvbnMpO1xyXG4gICAgcmV0dXJuIG9wdGlvbnMuaW5jbHVkZVVwcGVyY2FzZSB8fCBvcHRpb25zLmluY2x1ZGVMb3dlcmNhc2UgfHwgXHJcbiAgICAgICAgICAgb3B0aW9ucy5pbmNsdWRlTnVtYmVycyB8fCBvcHRpb25zLmluY2x1ZGVTeW1ib2xzO1xyXG4gIH0gY2F0Y2gge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJ6IiwiVkFMSURBVElPTl9NRVNTQUdFUyIsIlBBU1NXT1JEX0NPTkZJRyIsImVtYWlsU2NoZW1hIiwic3RyaW5nIiwibWluIiwiRU1BSUxfUkVRVUlSRUQiLCJlbWFpbCIsIkVNQUlMX0lOVkFMSUQiLCJwYXNzd29yZFNjaGVtYSIsIk1JTl9MRU5HVEgiLCJQQVNTV09SRF9NSU5fTEVOR1RIIiwibWF4IiwiTUFYX0xFTkdUSCIsIlBBU1NXT1JEX01BWF9MRU5HVEgiLCJtYXN0ZXJQYXNzd29yZFNjaGVtYSIsIk1BU1RFUl9QQVNTV09SRF9SRVFVSVJFRCIsImxvZ2luU2NoZW1hIiwib2JqZWN0IiwibWFzdGVyUGFzc3dvcmQiLCJyZWdpc3RlclNjaGVtYSIsImNyZWF0ZVBhc3N3b3JkU2NoZW1hIiwic2VydmljZSIsIlNFUlZJQ0VfUkVRVUlSRUQiLCJ1c2VybmFtZSIsIlVTRVJOQU1FX1JFUVVJUkVEIiwicGFzc3dvcmQiLCJ1cmwiLCJvcHRpb25hbCIsIm9yIiwibGl0ZXJhbCIsIm5vdGVzIiwidXBkYXRlUGFzc3dvcmRTY2hlbWEiLCJpZCIsInV1aWQiLCJnZW5lcmF0ZVBhc3N3b3JkU2NoZW1hIiwibGVuZ3RoIiwibnVtYmVyIiwiaW5jbHVkZVVwcGVyY2FzZSIsImJvb2xlYW4iLCJpbmNsdWRlTG93ZXJjYXNlIiwiaW5jbHVkZU51bWJlcnMiLCJpbmNsdWRlU3ltYm9scyIsImV4Y2x1ZGVTaW1pbGFyIiwidmFsaWRhdGVQYXNzd29yZCIsInJlcXVpcmVtZW50cyIsInVwcGVyY2FzZSIsInRlc3QiLCJsb3dlcmNhc2UiLCJudW1iZXJzIiwic3ltYm9scyIsIm1ldFJlcXVpcmVtZW50cyIsIk9iamVjdCIsInZhbHVlcyIsImZpbHRlciIsIkJvb2xlYW4iLCJzY29yZSIsImZlZWRiYWNrIiwicHVzaCIsIk1hdGgiLCJzYW5pdGl6ZUlucHV0IiwiaW5wdXQiLCJ0cmltIiwicmVwbGFjZSIsImlzVmFsaWRVVUlEIiwidXVpZFJlZ2V4IiwiaXNWYWxpZEVtYWlsIiwicGFyc2UiLCJ2YWxpZGF0ZUdlbmVyYXRvck9wdGlvbnMiLCJvcHRpb25zIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/validation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/zod","vendor-chunks/semver","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5CAbraham%5COneDrive%5CUniversidad%5CMaestria%5CModulo%207%5CProyecto%20Final%5Cmaestria_proyecto_v7%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAbraham%5COneDrive%5CUniversidad%5CMaestria%5CModulo%207%5CProyecto%20Final%5Cmaestria_proyecto_v7&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();